<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
    <head>
        <title>KGGSeq Online User Manual</title>
        <style type="text/css">        

            /* overall styles */
            body {
                font:                   11pt Arial;
                margin-top:             0.5em;
                margin-bottom:          0.5em;
                margin-left:            2px;
                margin-right:           0;
                color:                  black;
                line-height:            1.3em;
            }
            #menu {
                display: block;
                top: 5px;
                right: 5px;
                width: 80px;
                position: fixed;
                border: solid 1px #cccccc;
                font-family: Arial, serif;
                background-color: #C7EDCC
            }
            * html #menu {
                position:absolute;
                top: expression(offsetParent.scrollTop+document.documentElement.clientHeight-this.offsetHeight)
            }

            .links
            {
                margin: 0px;
                padding:        6px;
                border: 0px inset #000000;
                max-width: 90%;
                background:     white;
            }

            /* various link styles */
            a
            {
                margin-right:           0;
                text-decoration:        none;
                border-bottom:          1px solid gray;
                white-space:            nowrap;
            }

            a:link
            {
                color:                  black;
            }

            a:visited
            {
                color:                  black;
                border-bottom:          1px solid gray;
            }

            a:active
            {
                color:                  yellow;
            }

            a:hover
            {
                color:                   #5A867B;
                border-bottom:          1px solid black;
            }

            h1 {
                margin-left:            0;
                margin-right:           0;
                width: 100%;
                padding-left:  5px;
                padding-right:  20px;
                margin-left:            0px;
                margin-bottom:          -1px;
                text-align: justify;
                font-size: 150%;
                font-weight:bold;
            }
            /* this is the indenting procedure for major categories */
            h2
            {
                border-left: 2px solid #225522;
                border-top: 2px solid #225522;
                margin-left:            0;
                margin-right:           1px;
                width: 100%;
                padding-left:  5px;
                padding-right:  20px;
                background:     #f0f5f0;
                text-align: justify;
                font-size: 120%;
            }

            /* this is for category headings */
            h3
            {
                border:                 1px dotted #000000;
                border-top:             1px dotted #000000;
                border-right:           1px dotted #000000;
                padding-bottom:         2px;
                padding-top:            0px;
                padding-right:          20px;
                padding-left:           20px;
                margin-left:            0px;
                margin-top:             3em;
                margin-bottom:          -1px;
                background:             #335522;
                font-size:              100%;
                color:                  #FFFFFF;
                font-weight:            normal;
            }

            h4
            {
                border:#CCC 1px dotted;
                padding-bottom:         2px;
                padding-top:            0px;
                padding-right:          20px;
                padding-left:           20px;
                margin-left:            10px;
                margin-right:           10px;
                /*                margin-top:             3em; */
                margin-bottom:          -1px;
                background:#E8E8E8           ;
                font-size:		90%;
                text-align: 		justify;
                font-weight:        normal;
                font-style:italic;
            }

            strong
            {
                border:                 1px solid #000000;
                padding-bottom:         1px;
                padding-top:            1px;
                padding-right:          20px;
                padding-left:           20px;
                margin-left:            1px;
                margin-top:             5em;
                margin-bottom:          2px;
                background:#FCF            ;
                font-size:              100%;
                font-weight:            normal;
            }

            code {
                display:block;
                style: overflow: auto;
                /* white-space: pre; */
                white-space: pre-wrap;       /* css-3 */
                white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
                white-space: -pre-wrap;      /* Opera 4-6 */
                white-space: -o-pre-wrap;    /* Opera 7 */
                word-wrap: break-word;       /* Internet Explorer 5.5+ */

                color: #333;
                font-family: courier;
                font-size: 95%;
                margin-top: 20px;
                margin-left: 40px;
                margin-right: 40px;
                margin-bottom: 10px;
                padding-left: 10px;
                padding-right: 10px;
                background-color: #F4F4FF;
                border-left: 2px solid;
                border-color: #337;
            }

            table.list {
                width:80%;
                text-align:justify;
                background-color:#F5F5F5;
                margin-left:auto;
                margin-right:auto;
                margin-top:5px;
                margin-bottom:5px;
                border-collapse: collapse;
                border:1px dotted #66CC00;
            }
            table.list TD {
                border:1px dashed  #999999;

            }


            .textsurround{float: right;
                          margin-right: 5px;}          


        </style>
        <!--[if IE 6]>
            <style type="text/css">
            /*<![CDATA[*/
        html {overflow-x:auto; overflow-y:hidden;}
            /*]]>*/
            </style>
        <![endif]-->
    </head>

    <body>
        <div style="position:absolute;left: 3px ;top: 3px">
            <table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
                <tr>
                    <td  width="180px" align="left" valign="top" bgcolor="C7EDCC">
                        <p><a name="Navi:introduction" href="#introduction">Introduction  and References</a></p>
                        <p>   
                            <a name="Navi:installandrun">Install  and run</a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />    <a href="#SystemRequirement">System       requirement</a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />    <a href="#InstallingKGGSeq">Installing       KGGSeq</a>   <br />
                        </p>
                        <p> 
                            <a name="Navi:shorttutorials"> Short Tutorials</a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />    <a href="MendelianDisease.htm" target="_blank">Mendelian Disease</a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />      <a href="SomaticDriver.htm" target="_blank">Cancer Somatic</a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />     <a href="Denovo.htm" target="_blank"><I>De novo</I></a><br />
                            <img src="imgs/head1.gif" width="12" height="12" />     <a href="DoubleHitGene.htm" target="_blank">Double Hit Gene</a>
                        </p>
                        <p>
                            <a name="Navi:quickexamples"> Quick examples</a> <br />
                            <img src="imgs/head1.gif" width="12" height="12" />  <a href="#MendelianDiseaseHg19">Mendelian disease</a>  
                        </p>
                        <p>
                            <a name="Navi:options"> Options</a> <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#EnvironmentalSettings">Environmental       settings</a><br />
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#InputFormats">Inputs</a><br />
                            &nbsp;&nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#VariantsAndGenotypes">Variants&amp;genotypes</a><br />
                            &nbsp;&nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PhenotypesAndPedigree">Phenotype&amp;pedigree</a><br />
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#Outputs"> Outputs</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#OdinaryOutputs">Ordinary outputs</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#BinaryOutputs">Binary outputs</a><br />
                            <br />

                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#QualityControl" target="_self">Quality Control</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#GenotypeQC" target="_self">Genotype QC</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#VariantQC" target="_self">Variant QC</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#SampleQC" target="_self">Sample QC</a><br />
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#FilteringAndPrioritization" target="_self">Filtering </a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#GeneticInheritanceSharing" target="_self">Genetic inheritance </a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#GeneFeatureFiltering" target="_self">Gene feature</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#AlleleFrequencyTrimming" target="_self">Allele frequency</a> <br />                                   
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#VariantTypeAndRegionFiltering" target="_self">Type&amp;region&amp;gene</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#SupperDuplicateRegionFiltering" target="_self">Supper duplicate</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#TooManyVarGeneFiltering" target="_self">Gene&#39;s Variant number</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PhenotypeRelevantFiltering" target="_self">Phenotype</a><br />

                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#Annotation" target="_self">Annotation</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#FunctionalAnnotation" target="_self">Functional annotation</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#SharedProteinProteinInteractions" target="_self">Protein interaction</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#SharedGeneSets" target="_self">GeneSet</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PubMedTextMining" target="_self">PubMed literature</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#OMIMTextMining" target="_self">OMIM</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#COSMICMining" target="_self">COSMIC</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#dbSNPRSID" target="_self">dbSNP RSID</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#splicingAnnote" target="_self">Alternative splicing</a><br />


                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#PredictionVar" target="_self">Prediction at variant</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PredictingMendelianDiseaseCausingVariants" target="_self">Mendelian disease</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PredictingCancerCausingVariants" target="_self">Cancer somatic driver</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PredictingComplexDiseaseCausingVariants" target="_self">Complex disease</a><br />                                 
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#PredictionGene" target="_self">Prediction at gene</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#Pathogenicity" target="_self">Pathogenicity </a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#PhenotypeMining" target="_self">Phenotype mining</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#Expression" target="_self">Expression</a><br />                                    
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" /> <a href="#AssociationEnrichment" target="_self">Association&amp;enrichment</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#AssociationVariant" target="_self">Association at variant </a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#AssociationGene" target="_self">Association at gene</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#MutationRateGene" target="_self">Mutation rate at gene</a><br />      
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#GeneSetEnrichment" target="_self">GeneSet enrichment</a><br />      
                            <br />
                            <img src="imgs/head1.gif" width="12" height="12" />  <a href="#Plotting" target="_self">Plotting</a><br />

                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#AlleleFrequency" target="_self">Allele frequency</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#QQPlot" target="_self">Q-Q</a><br />
                            &nbsp; &nbsp;<img src="imgs/leaf.gif" width="10" height="8" /><a href="#ManhattanPlot" target="_self">Manhattan </a><br />    

                        </p>
                        <a name="Navi:faq" href="#faq"> FAQ</a>
                    </td>

                    <td>
                        <table width="97%" border="0" cellspacing="5" cellpadding="0" align="center">
                            <tr> 
                                <td >
                                    <table>
                                        <tr> 
                                            <td >
                                                <p> <h1> KGGSeq: A biological Knowledge-based  mining platform for Genomic and Genetic studies using Sequence data </h1> </p>
                                                <p align="center" >(Version 1.0)<br />
                                                    Miaoxin Li,Jiang Li, Zhicheng Pan, Jun Li, Hongsheng Gui, Suying Bao and  JS Kwan</p>
                                                <hr />
                                                <h1><a id="introduction"> Introduction </a> </h1><br />   
                                                <b>KGGSeq</b> is designed to make use of biological knowledge and statistical models to identify genetic loci responsible for human diseases/traits by high-throughput sequencing data. Compared with other tools like Plink/Seq (&ldquo;A  library for the analysis of genetic variation data&rdquo;, http://atgu.mgh.harvard.edu/plinkseq/),  KGGSeq focuses more on integrative downstream analysis. Since version 1.0, it has been equipped with a series of integrative methods for characterizing genetic mutations/polymorphsim of Mendelian disorders, complex disorders and cancers by using whole genome sequencing data and versatile  public resources  .
                                            </td>
                                            <td >
                                                <img src="imgs/kggseqworkflow.fw.png" width="363" height="308" alt="WorkFlowFig"  class="textsurround" /> 	
                                            </td>
                                        </tr>

                                    </table>
                                </td>
                            </tr>

                            <tr >
                                <td><h3>References</h3>
                                    1. &nbsp;&nbsp;Li MX, Gui HS, Kwan JS, Bao SY, Sham PC. A comprehensive framework for prioritizing variants in exome sequencing studies of Mendelian diseases.Nucleic Acids Res. 2012 Apr;40(7):e53.  <a href="http://www.ncbi.nlm.nih.gov/pubmed/22241780" target="_blank">PubMed</a>&nbsp; &nbsp;<a href="http://nar.oxfordjournals.org/content/40/7/e53.long" target="_blank">NAR</a>
                                    <br />
                                    2. &nbsp;&nbsp;Li et al. Predicting Mendelian disease-causing non-synonymous single nucleotide variants in exome sequencing studies. PLoS Genet. 2013 Jan;9(1):e1003143. <a href="http://www.ncbi.nlm.nih.gov/pubmed/23341771" target="_blank">PubMed</a> &nbsp; &nbsp;<a href="http://www.plosgenetics.org/article/info%3Adoi/10.1371/journal.pgen.1003143" target="_blank">PLoS Genet</a><br />
                                </td>
                            </tr>
                            <tr >
                                <td>
                                    <hr />
                                    <h1>Install and run</h1>
                                    <h2>                 <a id="SystemRequirement" > System requirement </a>   </h2>
                                    <p>Java Runtime Environment (JRE) version 1.6 (or up) is required for KGGSeq. It can be downloaded from the Java web site.
                                        Installing the JRE is very easy in Windows OS and Mac OS X.<br />
                                        <br />
                                        In Linux, you have more work to do. Details of the installation can be found http://www.java.com/en/download/help/linux_install.xml.                             <br />
                                        <br />
                                        In Ubuntu, if you have an error message like: &quot;Exception in thread &quot;AWT-EventQueue-0&quot; java.awt.HeadlessException ... &quot; , please install the Sun Java Running Environment (JRE) first.

                                        <h4>To install the Sun JRE on Ubuntu(10.04), please use the following commands:<br />
                                            sudo add-apt-repository "deb http://archive.canonical.com/ lucid partner"<br />
                                            sudo apt-get update<br />
                                            sudo apt-get install sun-java6-jre sun-java6-plugin sun-java6-fonts<br />
                                            Detailed explanation of above commands can be found at http://www.ubuntugeek.com/how-install-sun-java-runtime-environment-jre-in-ubuntu-10-04-lucid-lynx.html.</h4>
                                        <br />

                                        <p>For Mac OS, the JRE 1.6 has been available at http://developer.apple.com/java/download/ since April 2008. Mac OS users may need update the Java application to run KGGSeq. A potential problem is that this update does not replace the existing installation of J2SE 5.0 or change the default version of Java. Similar to the Linux OS, the Java_Home environmental variable has to be configured to initiate KGGSeq. </p>
                                        <p>&nbsp;</p>
                                </td>
                            </tr>
                            <tr >
                                <td >
                                    <h2><a  id="InstallingKGGSeq" >Installing KGGSeq</a> </h2>
                                    <p>Simply decompress the archive and run the  following command</p>
                                    <p><code> &nbsp; java -Xmx1300m -jar ./kggseq.jar  &lt;arguments&gt; </code></p>
                                    <p>The arguments <tt>-Xmx1300m</tt> set the maximum Java  heap sizes for KGGSeq as 1.3 gigabytes. Specifying a larger maximum heap size can speed up the analysis when processing large datasets. A higher setting like <tt>-Xmx2g</tt> or even<tt>-Xmx5g</tt> is required when there is a large number of variants, say 5 million. The number, however, should be  less than the size of physical memory of a machine. </p>
                                    <p><strong>Note</strong>&nbsp;  <font class="textMark">&lt;arguments &gt;</font><b>can be saved in a flat text file.</b></p>

                                    <br /> <strong>Note</strong>&nbsp;  To use KGGSeq under Proxy  Network, you need specifically use the following java command to configure the  proxy settings (Thank Daniele Yumi for this suggestion): <br />
                                    <code>  java -Dhttp.proxyHost=xxx.xxx.xxx -Dhttp.proxyPort=xxxx -Dhttp.proxyUser=xxx -Dhttp.proxyPassword=xxx -jar "./kggseq.jar"  </code> 
                                </td>
                            </tr>
                            <tr >
                                <td >
                                    <hr />
                                    <h1>Quick       example</h1>

                                    <p ><a   id="MendelianDiseaseHg19" class="h2"> Example : </a> <b> Prioritize variants for a rare Mendelian disease </b></p>
                                    <p>Files needed:<br />
                                        1)a VCF file (rare.disease.hg19.vcf); and<br />
                                        2)a linkage pedigree file (rare.disease.ped.txt). </p>
                                    <p><strong>Note</strong>&nbsp; <b> All files  were included in the examples folder of KGGSeq. </b></p>
                                    <p>Run the command below:</p>
                                    <code>java -Xmx1300m -jar kggseq.jar examples/param.rare.disease.hg19.txt</code>
                                    <p>We now walk through the parameter file &ldquo;param.rare.disease.hg19.txt&rdquo;  before going into the results. Lines starting with hash sign <b>#</b> are  comments. Detailed interpretation for each argument in the parameter file is  included in 'Options' part.</p>

                                    <h4>

                                        <p>#one argument per line<br />
                                            #I.Environmental setting<br />
                                            --buildver hg19 \                           \ #line 1<br />
                                            --resource ./resources \                    \ #line 2<br />
                                            #--no-lib-check                              \ #line 3<br />
                                            #--no-resource-check \                       \ #line 4</p>
                                        <p>#II. Specify the input files<br />
                                            --vcf-file examples/rare.disease.hg19.vcf    \ #line 5<br />
                                            --ped-file examples/rare.disease.ped.txt     \ #line 6, or specify --indiv-pheno X:1,Y:1,Z:2</p>
                                        <p>#III. Output setting<br />
                                            --out ./test1                           \ #line 7<br />
                                            --excel                                      \ #line 8<br />
                                            --o-seattleseq                               \ #line 9<br />
                                            --o-vcf                                      \ #line 10<br />
                                            #--o-flanking-seq 50                         \ #line 11, need large RAM memory</p>
                                        <p>#IV. QC<br />
                                            --gty-qual 10                                \ #line 12<br />
                                            --gty-dp 4                                   \ #line 13<br />
                                            --gty-af-ref 0.05                            \ #line 14<br />
                                            --gty-af-het 0.25                            \ #line 15<br />
                                            --vcf-filter-in PASS,VQSRTrancheSNP90.00to93.00,VQSRTrancheSNP93.00to95.00,VQSRTrancheSNP95.00to97.00,VQSRTrancheSNP97.00to99.00                         \ #line 16<br />
                                            --seq-qual 50                                \ #line 17<br />
                                            --seq-mq 20                                  \ #line 18<br />
                                            --seq-sb 0                                   \ #line 19<br />
                                            --min-obsa 1                                 \ #line 20<br />
                                            --min-obsu 0                                 \ #line 21</p>
                                        <p>#V. Filtering and Prioritization<br />
                                            --genotype-filter 3                          \ #line 22<br />
                                            --ibs-case-filter 1000                                 \ #line 23, or specify 'ibdregions.txt' file<br />
                                            --db-gene refgene                            \ #line 24<br />
                                            --gene-feature-in 0,1,2,3,4,5,6                \ #line 25<br />
                                            --db-filter 1kg201204,dbsnp141,ESP6500AA,ESP6500EA \ #line 26<br />
                                            --rare-allele-freq 0.006                     \ #line 27<br />
                                            --db-score dbnsfp                            \ #line 28<br />
                                            --filter-nondisease-variant                  \ #line 29<br />
                                            --regions-out chrX,chrY                      \ #line 30</p>
                                        <p>#VI. Annotation<br />
                                            --genome-annot                                \#line 31<br />
                                            --candi-list ATXN1,ATXN2,ATXN8OS,ATXN8,ATXN10,TTBK2 \ #line 32<br />
                                            --geneset-annot cura                         \ #line 33<br />
                                            --ppi-annot string                           \ #line 34<br />
                                            --ppi-depth 1                                \  #line 35<br />
                                            --pubmed-mining Spinocerebellar+ataxia       \ #line 36</p>


                                    </h4>

                                    <p><b>Part (I): Specify general environmental setting</b></p>
                                    <p> Argument &lsquo;line 1~4&rsquo; is used to set general KGGSeq running enviroment, including human genome build, resource path and program update </p>
                                    <p><b>Part (II): Specify the input files </b></p>
                                    <p><b> </b>Arguments &lsquo;line 5~6&rsquo; are used to specify the  input files which support various data format, and they are compulsory for running KGGSeq. </p>
                                    <p><b>Part (III): Output setting</b></p>
                                    <p> Argument &lsquo;line 7~11&rsquo; is used to set the output file name and type, which can be produced simutaneously by KGGSeq.</p>
                                    <p><b>Part (IV): Specify Quality control conditions</b></p>
                                    <p> Arguments &lsquo;line 12~21&rsquo; are used to apply QC conditions (Genotype or Variant level) on input dataset, and then exclude low quality genotypes or variants in the following analysis. </p>
                                    <p><b>Part (V): Filtering and Prioritization</b></p>
                                    <p> Arguments &lsquo;line 22~30&rsquo; are used to apply a combination of filters (genetic inheritance, gene feature, allele frequency, functional importance, etc) to enable better prioritization of the key variants/genes. </p>
                                    <p><b>Part (VI): Annotation</b></p>
                                    <p> Arguments &lsquo;line 31~36&rsquo; are used to annotate remained  list of variants/genes by searching various genomic annotation database and literature evidence.</p>
                                    <p></p>
                                    <p><strong>Notes</strong> Most of the above arguments are optional  (except line 5 and 6), so user can mask some lines by &ldquo;#&rdquo; or delete the  lines. Under this circumstance, user can have a systematic view of the impact  for each level or even steps. And it will be easier to produce this parameter  file by Kggseq command generator we provide. </em></p>
                                    <p></p>
                                    <p>After running KGGSeq, you will get three file named &lsquo;<b>test0808_1.fit.xls</b>&rsquo;, &lsquo;<b>test0808_1.fit.vcf</b>&rsquo;, and &lsquo;<b>test0808_1.fit.seattleseq</b>&rsquo; in the same directory of KGGSeq.jar. For this example case, 2 missense variants residing in CTBP2 gene are retained and all of them are predicted to be disease  causal.
                                        We also provide another 5 quick examples (corresponding to different input datasets) in the same folder. Users are recommended to practice each of them for a better understanding of each parameter and their combinations.</p>
                                </td>
                            </tr>
                            <tr>
                                <td><hr /><h1> Options  </h1>
                                    <h2><a name="EnvironmentalSettings" >Environmental settings</a></h2>

                                    <img src="imgs/leaf.gif" width="10" height="8" />  Set the version of reference human genome build<code>java -jar kggseq.jar --buildver hg##</code> <p>All inputs  will be analyzed and ouputted according to the setted genome version.<br />
                                        <br />

                                        <strong>NOTE </strong>
                                        &nbsp;Currently, KGGSeq only supports hg18 and hg19. It is <tt>--buildver hg19</tt> by default.
                                    </p>
                                    <img src="imgs/leaf.gif" width="10" height="8"/>  Specify the local path to store the resource datasets <code>java -jar kggseq.jar --resource path/to/resource/files</code>
                                    <p>Once initiated, KGGSeq will automatically download the resource data from its web server to the local folder. By default, it is --resource "./"<br />
                                    </p>
                                    <img src="imgs/leaf.gif" width="10" height="8" />   Switch off the auto-checking function for itself.
                                    <code>java -jar kggseq.jar --no-lib-check</code>
                                    <p>By default, KGGSeq will automatically check and download the available latest version of it, once initiated.<br />
                                    </p>

                                    <img src="imgs/leaf.gif" width="10" height="8" /> Switch off the auto-checking function for all relevant resource datasets.
                                    <code>java -jar kggseq.jar --no-resource-check</code>
                                    <p>By default, KGGSeq will automatically check and download the available latest version of resource datasets, once initiated.<br />
                                    </p>

                                    <img src="imgs/leaf.gif" width="10" height="8" /> Switch off the auto-log function to write log in a text file.
                                    <code>java -jar kggseq.jar --no-log</code>
                                    <p>By default, KGGSeq will automatically write log in a text file.<br />
                                    </p>

                                </td>
                            </tr>
                            <tr>
                                <td >
                                    <h2><a name="InputFormats" >Input formats </a></h2><h3><a name="VariantsAndGenotypes" >
                                            Variants and genotypes
                                        </a> </h3><br />
                                    <a href="http://www.1000genomes.org/node/101" target="_blank">VCF format with genotypes</a><br />
                                    <img src="imgs/leaf.gif" width="10" height="8" />  The format KGGSeq supporting best is the <a href="http://www.1000genomes.org/node/101" target="_blank">VCF</a> format, which stored sequence variants and called genotype information. The VCF file can be flat text or be compressed as .gz.
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2</code> <p><br />
                                        <strong>NOTE </strong>
                                        &nbsp;If the data were stored in different files chromosome by chromosome, you can use _CHROM_ to denote the chromosome names [1...Y] or directly specify [1,2,X]in the file name so that kggseq can read data in multiple files in a run.<br />
                                        <br />
                                        <strong>NOTE </strong>
                                        In the VCF file, each subject should have a unique SubjectID, which is used to link the <a href="#PhenotypesAndPedigree" target="_self">phenotypes and/or pedigree structure</a>.
                                    </p>
                                    <p>
                                        <a href="http://www.1000genomes.org/node/101" target="_blank">VCF format WITHOUT genotypes</a><br />
                                        KGGSeq can also accept VCF data without genotype information. But there are less usable functions for this type data.<br />
                                        <code>java -jar kggseq.jar --no-gty-vcf-file path/to/file1 </code>
                                    </p>
                                    <br />

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> In addition, KGGSeq also support other popular variants and/or genotypes formats which are popular in next generation studies.</p>
                                    <p><a href="http://www.openbioinformatics.org/annovar/annovar_input.html" target="_blank">ANNOVAR format</a>
                                        <code>java -jar kggseq.jar --annovar-file path/to/file</code>
                                        <strong>NOTE </strong>
                                        Since v0.4, KGGSeq recognize an extended ANNOVAR format in which a head row and and multiple columns for comments are allowed. <br />
                                        <h4>
                                            Example: <br />
                                            chr	startpos	endpos	ref		alt	comment1 comment2 comment3<br />
                                            1	69428	69428	T	G	T	92	129<br />
                                            1	69476	69476	T	C	T	1	0<br />
                                        </h4>
                                    </p>
                                    <p><a href="#kedformat">KGGSeq binary genotype file set</a> <tt>--ked-file</tt></p>
                                    <code>java -jar kggseq.jar --ked-file path/to/fileset</code>

                                    The KGGSeq binary genotype produced by KGGSeq, which is more flexible to store the different types of genotypes than the <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/binary.shtml" target="_blank">Plink BED</a> format.
                                    <h3><a name="PhenotypesAndPedigree" >
                                            Phenotypes and pedigree
                                        </a> </h3><br />
                                    When there are <b>genotypes</b> imputted say in VCF format, KGGSeq should know to whom they belong to and the phenotypes of the sample. So you need provide your sample information in this case.<br /><br />
                                    <img src="imgs/leaf.gif" width="10" height="8" /> Concise subject ID and disease status: <tt>--indiv-pheno </tt>
                                    <code>java -jar kggseq.jar --vcf-file path/to/file  --indiv-pheno SubjectID1:0,SubjectID2:2,...</code>
                                    Specify the individual IDs     and affection status, which is coded as: 0 missing or unknow,1 unaffected,2 affected.<br />
                                    <strong>Note</strong> &nbsp; The individual IDs <b>must</b> be unique and identical to the ones defined in the VCF file(s).                                    </p>
                                    <img src="imgs/leaf.gif" width="10" height="8" /> Conventional <a href="http://www.broadinstitute.org/science/programs/medical-and-population-genetics/haploview/input-file-formats-0" target="_blank">linkage pedigree file</a>:<tt> --ped-file </tt>
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 (or --composite-subject-id)</code>
                                    Specify the subject IDs,  relationship between subjects, and disease status of them; it is a conventional Linkage Format, detailed <a href="http://www.broadinstitute.org/science/programs/medical-and-population-genetics/haploview/input-file-formats-0" target="_blank">here</a>.<br />
                                    <h4>
                                        <ul>
                                            <li> <b>Pedigree Name</b><br/>
                                                A unique alphanumeric identifier for this individual's family. Unrelated individuals should not share a pedigree name.
                                            </li>
                                            <li> <b>Individual ID </b><br/>
                                                An alphanumeric identifier for this individual. Should be unique within his family (see above).
                                            </li>
                                            <li> <b>Father's ID </b><br/>
                                                Identifier corresponding to father's individual ID or "0" if unknown father. Note
                                                that if a father ID is specified, the father must also appear in the file.
                                            </li>
                                            <li> <b>Mother's ID</b><br/>
                                                Identifier corresponding to mother's individual ID or "0" if unknown mother Note that if a mother ID is specified, the mother must also appear in the file.
                                            </li>
                                            <li><b> Sex </b><br/>
                                                Individual's gender (1=MALE, 2=FEMALE).
                                            </li>
                                            <li> <b>Affection status</b> <br/>
                                                Affection status to be used for association tests (0=UNKNOWN, 1=UNAFFECTED,2=AFFECTED).
                                            </li>
                                        </ul>
                                        <strong>Note</strong> By default, the subject IDs in the VCF file must be identical to Individual IDs in the pedigree file, which are assumed unique in the whole pedigree file. However, one can also ask KGGSeq to use a composite subject ID in the CVF file as "PedigreeName$IndividualID" by the option <tt>--composite-subject-id</tt>.
                                    </h4>
                                </td>

                            </tr>
                            <tr>
                                <td>

                                    <h2><a name="Outputs" >Outputs </a></h2>
                                    <p>KGGSeq can flexibly output different formats of the prioritization and annotation results for validation or further analysis by third-party tools.</p>
                                    <p>Output file path and file name prefix: <tt>--out</tt><code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname</code>
                                        Specify path and prefix name of outputs. It is &quot;.<b>/kggseq</b>&quot;  by default. </p>


                                    <h3><a name="OdinaryOutputs" >  Odinary outputs
                                        </a> </h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Text format:<tt> This is by default</tt><code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 </code>
                                        By default, KGGSeq output results in TEXT format in a file named kggseq.flt.txt, in which the fields (or columns) are delimited by the tabs.</p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Excel format: <tt>--excel</tt>
                                        <code>java -jar kggseq.jar --vcf-file path//to/file1 --ped-file path/to/file2  --excel</code>
                                        The results will be stored in a Excel file with the name kggseq.flt.xls.</p>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Produce <a href="http://www.openbioinformatics.org/annovar/annovar_input.html" target="_blank">ANNOVAR</a> input: <tt>--o-annovar</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2  --o-annovar</code>
                                        Generate an extra copy of output for the prioritized variants in ANNOVAR input format, which can be further annotated by ANNOVAR.</p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Produce <a href="http://www.1000genomes.org/node/101" target="_blank">VCF</a> input: <tt>--o-vcf</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2  --o-vcf</code>
                                        Generate an extra copy of output for the prioritized variants in VCF format, which can be further analyzed by other tools.</p>

                                    <strong>Note</strong>  Please use <tt>--missing-gty X</tt> to denote missing genotypes in the output VCF file. It is <tt>--missing-gty ./.</tt> by default.

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Produce <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/" target="_blank">PLINK</a> input: <tt>--o-plink-ped</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2  --o-plink-ped</code>
                                        Generate an extra copy of output for the prioritized variants in PLINK <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/data.shtml#ped" target="_blank">PED</a> and <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/data.shtml#map" target="_blank">MAP</a> file, which can be further annotated by PLINK.</p>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Extract the flanking sequence of each sequence variant: <tt>--o-flanking-seq</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2  --o-flanking-seq 50</code>
                                        The source sequence information is the UCSC Chromosome dataset <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg18/chromosomes/" target="_blank">hg18</a> or <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes/" target="_blank">hg19</a>, which are human genome reference sequences on the forward strand. The unit of the specified flanking sequence is base-pair(bp). The retrieved sequences will be in the *.flt.txt or *.flt.xls with the column label &quot;FlankingSeqXXbp&quot;.</p>
                                    <strong>Note</strong> Users might need set large memory (by <tt>-Xmx4g</tt>) to carry out this function as KGGSeq will load the whole sequences of a chromosome.

                                    <h3><a name="BinaryOutputs" >
                                            Binary outputs
                                        </a> </h3>
                                    <p>PLink <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/binary.shtml" target="_blank"> binary genotypes files set</a>: <tt>--o-plink-bed</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --composite-subject-id --o-plink-bed</code>
                                        Generate an extra copy of output for the prioritized variants  in PLink binary genotype format (SNP-major model), which can store the genotype information more efficiently.<br />
                                        <strong>Note</strong> This format does not support variants with over 2 alleles and phased genotypes, which will be ignored by Kggseq.To record this information, you are suggested to use the Kggseq binary genotype format (below).

                                        <p><a name="kedformat">Kggseq binary genotypes files set</a>: <tt>--o-ked</tt>
                                            <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --composite-subject-id --o-ked</code>
                                            Generate an extra copy of output for the prioritized variants in KGGSeq binary genotype format, which use much less  space to store the genotype information.<br />

                                            <h4>
                                                Here is an exmaple VCF file:
                                                <table  class="list">
                                                    <tr>
                                                        <td>##fileformat=VCFv4.0<br />
                                                            #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT 1$A 1$B 1$C<br />
                                                            chr1 4793 rs6682385 A G 596.57 PASS AC=2 GT 1/1 0/0 ./.<br />
                                                            chr1 53560 . T C 573.51 PASS AC=1; GT ./. 0/0 0/1<br />
                                                            chr1 12887054 rs3738105 T C,G 5572.99 PASS AC=2,1 GT 1/2 0/0 0/1</td>
                                                    </tr>
                                                </table>
                                                And the corresponding pedigree file:
                                                <table  class="list">
                                                    <tr>
                                                        <td >1 A 0 0 1 1<br />
                                                            1 B 0 0 2 1<br />
                                                            1 C A B 1 2</td>
                                                    </tr>
                                                </table>
                                                After running the command above, KGGSeq will generat three file:					           <br />
                                                <b>kggseq.ked</b> (the KGGSeq binary genotype file, genotype information)<br />
                                                <b>kggseq.fam</b> (first six columns of the conventional <a href="http://www.broadinstitute.org/science/programs/medical-and-population-genetics/haploview/input-file-formats-0" target="_blank">Linkage Pedigree file</a>)<br />
                                                <b>kggseq.bim</b> (extended MAP file: two extra cols for reference and alternative allele names, like: A G,C)<br />
                                                The<b> kggseq.fam</b> and <b>kggseq.bim</b> are similar to <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/binary.shtml" target="_blank">PLINK BED</a> format.<br />
                                                <br />
                                                But the <b>kggseq.ked</b> has a different way to present genotypes, which is more flexible.
                                                Here is the binary view of  <b>kggseq.ked</b> file:<br />
                                                <table  class="list">
                                                    <tr>
                                                        <td >   |-magic &nbsp; &nbsp;&nbsp;number--| &nbsp;&nbsp;|phase mode| &nbsp;|------------------genotype data-------------------|<br />
                                                            10011110 10000010 &nbsp; 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11010000 00011000 10100101 00000000</td>
                                                    </tr>
                                                </table>

                                                <br />
                                                The followings are the interpretation of the KGGSeq binary genotype file format
                                                <ul>
                                                    <li> First two bytes <tt>10011110 10000010 </tt> for the validation checking of a KGGSeq binary genotype file.</li>
                                                    <li> Third byte is <tt>00000000</tt> (Unphased genotypes) or <tt>00000001</tt> (Phased genotypes) </li>
                                                    <li> Genotype data, either for unphased or phased ones in Variant-major order ((i.e. list all individuals for the first Variant, all individuals for the second Variant, etc) ).
                                                        The 4th byte (<tt>11010000</tt>) denotes genotypes of chr1:4793. The A, B and C have bit genotypes 11,01 and 00 respectively. The 5th byte (<tt>00011000</tt> ) denotes genotypes of chr1:53560. The 6th and 7th bytes (<tt>10100101</tt> and <tt>00000000</tt>) present genotypes of chr1:12887054, which has three alleles.</li>
                                                    <li> New "row" in the VCF file always starts a new byte (8 bits) </li>   
                                                </ul>
                                                For each sequence variant, the number of bytes required to present a genotype is determined by the number of alleles and the genotype phase status.<br />
                                                <b>I. Unphased -genotypes</b><br />
                                                I.I Bi-allelic sequence variant (2 bits)
                                                <table  class="list">
                                                    <tr >
                                                        <td   valign="top">&nbsp;</td>
                                                        <td   valign="top">missing</td>
                                                        <td   valign="top">Reference homozygous</td>
                                                        <td  valign="top">Heterozygous </td>
                                                        <td   valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr >
                                                        <td  valign="top">VCF genotype</td>
                                                        <td  valign="top">./.</td>
                                                        <td  valign="top">0/0</td>
                                                        <td   valign="top">0/1</td>
                                                        <td  valign="top">1/1</td>
                                                    </tr>
                                                    <tr  >
                                                        <td width="127" valign="top">Bits</td>
                                                        <td width="130" valign="top">00</td>
                                                        <td width="127" valign="top">01</td>
                                                        <td width="127" valign="top">10</td>
                                                        <td width="127" valign="top">11</td>
                                                    </tr>
                                                    <tr >
                                                        <td width="127" valign="top">Decimal</td>
                                                        <td width="130" valign="top">0</td>
                                                        <td width="127" valign="top">1</td>
                                                        <td width="127" valign="top">2</td>
                                                        <td width="127" valign="top">3</td>



                                                    </tr>
                                                </table>
                                                I.II Tri-allelic sequence variant (3 bits)
                                                <table  class="list">
                                                    <tr>
                                                        <td width="128" valign="top">&nbsp;</td>
                                                        <td width="82" valign="top">missing</td>
                                                        <td width="115" valign="top">Reference homozygous</td>
                                                        <td width="116" valign="top">Heterozygous </td>
                                                        <td width="119" valign="top">Heterozygous</td>
                                                        <td width="95" valign="top">Alternative homozygous</td>
                                                        <td width="115" valign="top">Heterozygous</td>
                                                        <td width="121" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="128" valign="top">VCF genotype</td>
                                                        <td width="82" valign="top">./.</td>
                                                        <td width="115" valign="top">0/0</td>
                                                        <td width="116" valign="top">0/1</td>
                                                        <td width="119" valign="top">0/2</td>
                                                        <td width="95" valign="top">1/1</td>
                                                        <td width="115" valign="top">1/2</td>
                                                        <td width="121" valign="top">2/2</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="128" valign="top">Bits</td>
                                                        <td width="82" valign="top">000</td>
                                                        <td width="115" valign="top">001</td>
                                                        <td width="116" valign="top">010</td>
                                                        <td width="119" valign="top">011</td>
                                                        <td width="95" valign="top">100</td>
                                                        <td width="115" valign="top">101</td>
                                                        <td width="121" valign="top">110</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="128" valign="top">Decimal</td>
                                                        <td width="82" valign="top">0</td>
                                                        <td width="115" valign="top">1</td>
                                                        <td width="116" valign="top">2</td>
                                                        <td width="119" valign="top">3</td>
                                                        <td width="95" valign="top">4</td>
                                                        <td width="115" valign="top">5</td>
                                                        <td width="121" valign="top">6</td>
                                                    </tr>
                                                </table>
                                                I.III Quad-allelic sequence variant (4 bits)
                                                <table class="list">
                                                    <tr>
                                                        <td width="129" valign="top">&nbsp;</td>
                                                        <td width="96" valign="top">missing</td>
                                                        <td width="111" valign="top">Reference homozygous</td>
                                                        <td width="106" valign="top">Heterozygous </td>
                                                        <td width="115" valign="top">Heterozygous</td>
                                                        <td width="106" valign="top">Heterozygous</td>
                                                        <td width="100" valign="top">Alternative homozygous</td>
                                                        <td width="128" valign="top">Heterozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="129" valign="top">VCF genotype</td>
                                                        <td width="96" valign="top">./.</td>
                                                        <td width="111" valign="top">0/0</td>
                                                        <td width="106" valign="top">0/1</td>
                                                        <td width="115" valign="top">0/2</td>
                                                        <td width="106" valign="top">0/3</td>
                                                        <td width="100" valign="top">1/1</td>
                                                        <td width="128" valign="top">1/2</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="129" valign="top">Bits</td>
                                                        <td width="96" valign="top">000</td>
                                                        <td width="111" valign="top">0001</td>
                                                        <td width="106" valign="top">0010</td>
                                                        <td width="115" valign="top">0011</td>
                                                        <td width="106" valign="top">0100</td>
                                                        <td width="100" valign="top">0101</td>
                                                        <td width="128" valign="top">0110</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="129" valign="top">Decimal</td>
                                                        <td width="96" valign="top">0</td>
                                                        <td width="111" valign="top">1</td>
                                                        <td width="106" valign="top">2</td>
                                                        <td width="115" valign="top">3</td>
                                                        <td width="106" valign="top">4</td>
                                                        <td width="100" valign="top">5</td>
                                                        <td width="128" valign="top">6</td>
                                                    </tr>
                                                </table>
                                                <table class="list">
                                                    <tr>
                                                        <td width="63" valign="top">&nbsp;</td>
                                                        <td width="88" valign="top">Heterozygous</td>
                                                        <td width="88" valign="top">Alternative homozygous</td>
                                                        <td width="88" valign="top">Heterozygous</td>
                                                        <td width="88" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">VCF genotype</td>
                                                        <td width="88" valign="top">1/3</td>
                                                        <td width="88" valign="top">2/2</td>
                                                        <td width="88" valign="top">2/3</td>
                                                        <td width="88" valign="top">3/3</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Bits</td>
                                                        <td width="88" valign="top">0111</td>
                                                        <td width="88" valign="top">1000</td>
                                                        <td width="88" valign="top">1001</td>
                                                        <td width="88" valign="top">1010</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Decimal</td>
                                                        <td width="88" valign="top">7</td>
                                                        <td width="88" valign="top">8</td>
                                                        <td width="88" valign="top">9</td>
                                                        <td width="88" valign="top">10</td>
                                                    </tr>
                                                </table><br />
                                                <b>II. Phased -genotypes</b><br />
                                                II.I Bi-allelic sequence variants (3 bits)
                                                <table class="list">
                                                    <tr>
                                                        <td width="106" valign="top">&nbsp;</td>
                                                        <td width="105" valign="top">missing</td>
                                                        <td width="112" valign="top">Reference homozygous</td>
                                                        <td width="114" valign="top">Heterozygous </td>
                                                        <td width="89" valign="top">Heterozygous </td>
                                                        <td width="112" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="106" valign="top">VCF genotype</td>
                                                        <td width="105" valign="top">.|.</td>
                                                        <td width="112" valign="top">0|0</td>
                                                        <td width="114" valign="top">0|1</td>
                                                        <td width="89" valign="top">1|0</td>
                                                        <td width="112" valign="top">1|1</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="106" valign="top">Bits</td>
                                                        <td width="105" valign="top">000</td>
                                                        <td width="112" valign="top">001</td>
                                                        <td width="114" valign="top">010</td>
                                                        <td width="89" valign="top">011</td>
                                                        <td width="112" valign="top">100</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="106" valign="top">Decimal</td>
                                                        <td width="105" valign="top">0</td>
                                                        <td width="112" valign="top">1</td>
                                                        <td width="114" valign="top">2</td>
                                                        <td width="89" valign="top">3</td>
                                                        <td width="112" valign="top">4</td>
                                                    </tr>
                                                </table>
                                                II.II          Tri-allelic sequence variant (4 bits)
                                                <table class="list">
                                                    <tr>
                                                        <td width="133" valign="top">&nbsp;</td>
                                                        <td width="93" valign="top">missing</td>
                                                        <td width="107" valign="top">Reference homozygous</td>
                                                        <td width="121" valign="top">Heterozygous </td>
                                                        <td width="100" valign="top">Heterozygous</td>
                                                        <td width="116" valign="top">Heterozygous</td>
                                                        <td width="102" valign="top">Heterozygous</td>
                                                        <td width="119" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="133" valign="top">VCF genotype</td>
                                                        <td width="93" valign="top">.|.</td>
                                                        <td width="107" valign="top">0|0</td>
                                                        <td width="121" valign="top">0|1</td>
                                                        <td width="100" valign="top">0|2</td>
                                                        <td width="116" valign="top">1|0</td>
                                                        <td width="102" valign="top">1|1</td>
                                                        <td width="119" valign="top">1|2</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="133" valign="top">Bits</td>
                                                        <td width="93" valign="top">000</td>
                                                        <td width="107" valign="top">0001</td>
                                                        <td width="121" valign="top">0010</td>
                                                        <td width="100" valign="top">0011</td>
                                                        <td width="116" valign="top">0100</td>
                                                        <td width="102" valign="top">0101</td>
                                                        <td width="119" valign="top">0110</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="133" valign="top">Decimal</td>
                                                        <td width="93" valign="top">0</td>
                                                        <td width="107" valign="top">1</td>
                                                        <td width="121" valign="top">2</td>
                                                        <td width="100" valign="top">3</td>
                                                        <td width="116" valign="top">4</td>
                                                        <td width="102" valign="top">5</td>
                                                        <td width="119" valign="top">6</td>
                                                    </tr>
                                                </table>
                                                <table class="list">
                                                    <tr>
                                                        <td width="63" valign="top">&nbsp;</td>
                                                        <td width="56" valign="top">Heterozygous</td>
                                                        <td width="83" valign="top">Heterozygous</td>
                                                        <td width="88" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">VCF genotype</td>
                                                        <td width="56" valign="top">2|0</td>
                                                        <td width="83" valign="top">2|1</td>
                                                        <td width="88" valign="top">2|2</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Bits</td>
                                                        <td width="56" valign="top">0111</td>
                                                        <td width="83" valign="top">1000</td>
                                                        <td width="88" valign="top">1001</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Decimal</td>
                                                        <td width="56" valign="top">7</td>
                                                        <td width="83" valign="top">8</td>
                                                        <td width="88" valign="top">9</td>
                                                    </tr>
                                                </table>
                                                <br />
                                                II.III Quad-allelic sequence variants (5 bits)
                                                <table class="list">
                                                    <tr>
                                                        <td width="130" valign="top">&nbsp;</td>
                                                        <td width="103" valign="top">missing</td>
                                                        <td width="116" valign="top">Reference homozygous</td>
                                                        <td width="104" valign="top">Heterozygous </td>
                                                        <td width="100" valign="top">Heterozygous</td>
                                                        <td width="111" valign="top">Heterozygous</td>
                                                        <td width="102" valign="top">Heterozygous</td>
                                                        <td width="125" valign="top">Heterozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="130" valign="top">VCF genotype</td>
                                                        <td width="103" valign="top">.|.</td>
                                                        <td width="116" valign="top">0|0</td>
                                                        <td width="104" valign="top">0|1</td>
                                                        <td width="100" valign="top">0|2</td>
                                                        <td width="111" valign="top">0|3</td>
                                                        <td width="102" valign="top">1|0</td>
                                                        <td width="125" valign="top">1|1</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="130" valign="top">Bits</td>
                                                        <td width="103" valign="top">00000</td>
                                                        <td width="116" valign="top">00001</td>
                                                        <td width="104" valign="top">00010</td>
                                                        <td width="100" valign="top">00011</td>
                                                        <td width="111" valign="top">00100</td>
                                                        <td width="102" valign="top">00101</td>
                                                        <td width="125" valign="top">00110</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="130" valign="top">Decimal</td>
                                                        <td width="103" valign="top">0</td>
                                                        <td width="116" valign="top">1</td>
                                                        <td width="104" valign="top">2</td>
                                                        <td width="100" valign="top">3</td>

                                                        <td width="111" valign="top">4</td>
                                                        <td width="102" valign="top">5</td>
                                                        <td width="125" valign="top">6</td>
                                                    </tr>
                                                </table>
                                                <table class="list">
                                                    <tr>
                                                        <td width="108" valign="top">&nbsp;</td>
                                                        <td width="119" valign="top">Heterozygous</td>
                                                        <td width="125" valign="top">Alternative homozygous</td>
                                                        <td width="135" valign="top">Heterozygous</td>
                                                        <td width="135" valign="top">Heterozygous</td>
                                                        <td width="135" valign="top">Heterozygous</td>
                                                        <td width="138" valign="top">Heterozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="108" valign="top">VCF genotype</td>
                                                        <td width="119" valign="top">1|2</td>
                                                        <td width="125" valign="top">1|3</td>
                                                        <td width="135" valign="top">2|0</td>
                                                        <td width="135" valign="top">2|1</td>
                                                        <td width="135" valign="top">2|2</td>
                                                        <td width="138" valign="top">2|3</td>

                                                    </tr>
                                                    <tr>
                                                        <td width="108" valign="top">Bits</td>
                                                        <td width="119" valign="top">00111</td>
                                                        <td width="125" valign="top">01000</td>
                                                        <td width="135" valign="top">01001</td>
                                                        <td width="135" valign="top">01010</td>
                                                        <td width="135" valign="top">01011</td>
                                                        <td width="138" valign="top">01100</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="108" valign="top">Decimal</td>
                                                        <td width="119" valign="top">7</td>
                                                        <td width="125" valign="top">8</td>
                                                        <td width="135" valign="top">9</td>
                                                        <td width="135" valign="top">10</td>
                                                        <td width="135" valign="top">11</td>
                                                        <td width="138" valign="top">12</td>
                                                    </tr>
                                                </table>
                                                <table class="list">
                                                    <tr>
                                                        <td width="63" valign="top">&nbsp;</td>
                                                        <td width="88" valign="top">Alternative homozygous</td>
                                                        <td width="56" valign="top">Heterozygous</td>
                                                        <td width="83" valign="top">Heterozygous</td>
                                                        <td width="83" valign="top">Alternative homozygous</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">VCF genotype</td>
                                                        <td width="88" valign="top">3|0</td>
                                                        <td width="56" valign="top">3|1</td>
                                                        <td width="83" valign="top">3|2</td>
                                                        <td width="83" valign="top">3|3</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Bits</td>
                                                        <td width="88" valign="top">01101</td>
                                                        <td width="56" valign="top">01110</td>
                                                        <td width="83" valign="top">01111</td>
                                                        <td width="83" valign="top">10000</td>
                                                    </tr>
                                                    <tr>
                                                        <td width="63" valign="top">Decimal</td>
                                                        <td width="88" valign="top">13</td>
                                                        <td width="56" valign="top">14</td>
                                                        <td width="83" valign="top">15</td>
                                                        <td width="83" valign="top">16</td>
                                                    </tr>
                                                </table>
                                            </h4>
                                        </p>
                                </td>
                            </tr>
                            <tr>
                                <td>

                                    <h2><a name="QualityControl" >Quality Control </a></h2>
                                    <p>After genetic variants were inputed from a variety of data formats, KGGSeq provides a few optional quality control filters on individual genotype, genomic variant and sample phenotype.
                                        By adopting one or a combination of these QCs before performing downstream prioritization/annotation, it could help the user to reduce false positives.</p>
                                    <h3><a name="GenotypeQC" >  Genotype QC </a> </h3><br />
                                    Typical information contained in individual genotype field usually covers read depth(<tt>--gty-dp</tt>), genotype quality (<tt>--gty-qual</tt>) and allelic balance ratio (<tt>--gty-af-ref</tt>, <tt>--gty-af-het</tt> and <tt>--gty-af-alt</tt>):
                                    <p><code>java -jar kggseq.jar --vcf-file path/to/file1 --indiv-pheno Indiv:1,Indiv:2 --gty-qual 10 --gty-dp 4 --gty-sec-pl 20 --gty-af-ref 0.05 --gty-af-het 0.25 --gty-af-alt 0.75 --o-vcf path/to/file2</code></p>
                                    <p> They are in relationship of logical AND, and not exclusive of each other,user can specify one or any combination of these parameters at one time.</p>
                                    <table class="list">
                                        <tr>
                                            <td>--gty-qual 10</td>
                                            <td width="83%">Exclude genotypes with the minimal genotyping quality (<a href="http://en.wikipedia.org/wiki/Phred_quality_score" target="_blank">Phred Quality Score</a>) per genotype &lt; 10. The default setting is <tt>--gty-qual 10</tt>.</td>
                                        </tr>
                                        <tr>
                                            <td>--gty-dp 4</td>
                                            <td>Exclude genotypes with the minimal read depth per genotype &lt; 4. The default setting is <tt>--gty-dp 4</tt>.</td>
                                        </tr>
                                        <tr>
                                            <td>--gty-sec-pl 20</td>
                                            <td>Exclude genotypes with the second smallest normalized, Phred-scaled likelihoods for genotypes &lt; 20. (otherwise, there would be confusing genotypes).The default setting is <tt>--gty-sec-pl 20</tt>.</td>
                                        </tr>
                                        <tr>
                                            <td>--gty-af-ref 0.05</td>
                                            <td>
                                                Exclude genotypes with the fraction of the reads carrying alternative allele &gt;= 5% at a reference-allele homozygous genotype, usually indicating by AF in a VCF file. The default setting is <tt>--gty-af-ref 0.05 </tt>. This tag can be disabled by <tt>--gty-af-ref 1 </tt></td>
                                        </tr>
                                        <tr>
                                            <td>--gty-af-het 0.25</td>
                                            <td>Exclude genotypes with the fraction of the reads carrying alternative allele &lt;= 25% at a heterozygous genotype.
                                                The default setting is <tt>--gty-af-het 0.25</tt>. This tag can be disabled by <tt>--gty-af-het 0 </tt></td>
                                        </tr>
                                        <tr>
                                            <td>--gty-af-alt 0.75</td>
                                            <td>Exclude variants with the fraction of the reads carrying alternative allele &lt;= 75% at a alternative-allele homozygous genotype.
                                                The default setting is <tt>--gty-af-alt 0.75</tt>. This tag can be disabled by <tt>--gty-af-alt 0 </tt></td>
                                        </tr>
                                        <tr>
                                            <td>--gty-somat-p 0.05</td>
                                            <td> Exclude genotypes at which the distribution of reads carrying reference and alternative alleles are not significantly (p&gt;0.05) different between tumor tissues and non-tumor tissues. By default, the p value threshold is 0.05.</td>
                                        </tr>
                                    </table>

                                    <p><strong>Note</strong> The AF is prioritized in the quality control process if the both AF and Ad are provided in the VCF file as the AF is usually estimated using high quality reads</p>
                                    <p>After running individual genotype QC, there will be two output files produced: one default Kggseq output stored in txt (or Excel by specifying "--excel"), in which the basic annotations for each clean variant are provided;
                                        the other one is clean vcf file, in which the genotype field which does not meet the conditions specified will be replaced by missing value ./., hence not considered in following analysis.</p>
                                    <h4>
                                        ##Key information provided in default basic annotation file:<br />
                                        "AffectedRefHomGtyNum", Number of affected individuals with reference homozygote at this variant;<br />
                                        "AffectedHetGtyNum", Number of affected individuals with heterozygote at this variant;<br />
                                        "AffectedAltHomGtyNum", Number of affected individuals with non-ref homozygote;<br />
                                        "UnaffectedRefHomGtyNum", Number of unaffected individuals with reference homozygote at this variant;<br /> Gene feature filtering
                                        "UnaffectedHetGtyNum", Number of unaffected individuals with heterozygote at this variant;<br />
                                        "UnaffectedAltHomGtyNum", Number of unaffected individuals with non-ref homozygote;
                                    </h4>
                                    <p><strong>Note</strong> The QC parameters in this section are designed for VCF input,which may not be suitable for other <a href="#InputFormats" target="_self">input formats</a>.</p>
                                    <p><strong>Note</strong> All above quality control functions at genotypes in VCF format can be turned off by  <tt>--no-qc</tt>.</p>
                                    <h3><a name="VariantQC" >  Variant QC </a> </h3><br />
                                    Each genomic variant corresponds to one row in the input dataset. Typical information for one variant includes overall sequencing quality (<tt>--seq-qual</tt>), RMS Mapping Quality (<tt>--seq-mq</tt>),
                                    and strand bias (<tt>--seq-sb</tt> or Phred-scaled p-value using Fisher's exact test <tt>--seq-fs</tt>). To make use of this information:
                                    <p><code>java -jar kggseq.jar --vcf-file path/to/file1 --indiv-pheno Indiv:1,Indiv:2 --vcf-filter-in PASS,VQSRTrancheSNP95.00to97.00,VQSRTrancheSNP97.00to99.00 --seq-qual 50 --seq-mq 20 --seq-sb -10 --seq-fs 60 --o-vcf path/to/file2</code></p>

                                    Interpretation of key parameters and their values:<br />
                                    <table  class="list">

                                        <tr>
                                            <td valign="top"><b>Arguments/values</b></td>
                                            <td valign="top"><b>Annotation</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">--vcf-filter-in</td>
                                            <td valign="top">exlude the variants with "FILTER" not matching the specified QC labels in the VCF input file. e.g., --vcf-filter-in PASS,VQSRTrancheSNP90.00to93.00,VQSRTrancheSNP93.00to95.00,VQSRTrancheSNP95.00to97.00,VQSRTrancheSNP97.00to99.00 . By default, this tag is ignored.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">--seq-qual 50</td>
                                            <td valign="top">set the minimum overall sequencing quality score (<a href="http://en.wikipedia.org/wiki/Phred_quality_score" target="_blank">Phred Quality Score</a>) for the variant at 50; </td>
                                        </tr>

                                        <tr>
                                            <td valign="top">--seq-mq 20</td>
                                            <td valign="top">set the minimum overall mapping quality score (<a href="http://en.wikipedia.org/wiki/Phred_quality_score" target="_blank">Phred Quality Score</a>) for the variant at 20; </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">--seq-sb -10</td>
                                            <td valign="top">set the maximal overall strand bias score for the variant at -10 </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">--seq-fs 60</td>
                                            <td valign="top">set the maximal overall strand bias Phred-scaled p-value (using Fisher's exact test) for the variant at 60; </td>
                                        </tr>

                                    </table>

                                    <p><strong>Note</strong> All above quality control functions at variants in VCF format can be turned off by  <tt>--no-qc</tt>.</p>

                                    <p>In addition, KGGSeq can make use of phenotype information (specified by "--indiv-pheno" or "--ped-file") to filter genomic variants. This QC is quite useful when multiple samples are included in one input file, like trio or case/control study design.</p>
                                    <p><code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --min-heta 1(or --min-homa 1) --min-hetu 1(or --min-homu1) --min-obsa 2(or --min-obsu 2) --min-obs 2 --o-vcf path/to/file3</code></p>

                                    <p>Moreover, this function can work with  options to flexibly set the sample size and missingness of genotypes. The following table list these options.
                                        <table  class="list">

                                            <tr>
                                                <td valign="top"><b>Arguments/values</b></td>
                                                <td valign="top"><b>Annotation</b></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-heta 1</td>
                                                <td valign="top">Set minimal observed number of heterozygotes genotypes in cases (the affected) as 1. </td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-homa 1</td>
                                                <td valign="top">Set minimal observed number of alternate homozygsote(s) genotypes in cases (the affected) as 1; <tt>--min-heta</tt> and <tt>--min-homa</tt> are logical OR relation.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-hetu 1</td>
                                                <td valign="top">Set minimal observed number of heterozygotes genotypes in controls (the unaffected) as 1. </td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-homu 1</td>
                                                <td valign="top">Set minimal observed number of alternate homozygsote(s) genotypes in controls(the unaffected) as 1; <tt>--min-hetu</tt> and <tt>--min-homu</tt> are logical OR relation.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-obsa 2</td>
                                                <td valign="top">Set minimal observed number of non-missing genotypes in cases (the affected) as 2.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-obsu 2</td>
                                                <td valign="top">Set minimal observed number of non-missing genotypes in controls(the unaffected) as 2; <tt>--min-obsa</tt> and <tt>--min-obsu</tt> are logical AND relation. </td>
                                            </tr>
                                            <tr>
                                                <td valign="top">--min-obs 2</td>
                                                <td valign="top">Set minimal observed number of non-missing genotypes in all samples as 2. </td>
                                            </tr>
                                            <tr>
                                                <td>--hwe-control 0.01</td>
                                                <td>Exclude variants in controls with the Hardy-Weinberg test p value &lt;= 0.01. By default, this tag is disabled.</td>
                                            </tr>
                                            <tr>
                                                <td>--hwe-case 0.01</td>
                                                <td>Exclude variants in cases with the Hardy-Weinberg test p value &lt;= 0.01. By default, this tag is disabled.</td>
                                            </tr>
                                            <tr>
                                                <td>--hwe-all 0.01</td>
                                                <td>Exclude variants in all subjects with the Hardy-Weinberg test p value &lt;= 0.01. By default, this tag is disabled.</td>
                                            </tr>
                                        </table>


                                        <p>After running individual genotype QC, there will be two output files produced: one default Kggseq output stored in txt (or Excel by specifying "--excel"), in which the basic annotations for each clean variant are provided (see above section);
                                            the other one is clean vcf file, in which the variant row which does not meet the conditions specified will be removed completely, hence not considered in following analysis.</p>
                                        <p><strong>Note</strong> The genomic variant QC is also available for non-vcf type of input, by using type of variants, or genomic position only.</p>
                                        <h3><a name="SampleQC" > Sample QC </a> </h3><br />
                                        KGGSeq provides two set of functions to facilitate quality assessment of sequencing data of each subject. <br />

                                        Firstly, you can use KGGSeq to convert genotypes from  <a href="http://www.1000genomes.org/node/101" target="_blank">VCF</a> format to  Plink binary genotype format (see <a href="#BinaryOutputs" target="_self">Outputs</a> part) so that routine sample QC (<a href="http://pngu.mgh.harvard.edu/~purcell/plink/ibdibs.shtml#genome" target="_blank">pairwise relatedness</a>, <a href="http://pngu.mgh.harvard.edu/~purcell/plink/summary.shtml#mendel" target="_blank">mendel error rate</a> and <a href="http://pngu.mgh.harvard.edu/~purcell/plink/summary.shtml#sexcheck" target="_blank">sex check</a>) in genome-wide association study (GWAS) analysis can be performed quickly. The samples with unexpected relationship or error rate are suggested to be removed.
                                        <p><code>java -jar kggseq.jar --vcf-file path-to-file1 --ped-file path/to/file2 &lt;Variants and Genotype QC Settings&gt; --db-merge &lt;Reference genotype set&gt; --o-plink-bed </code>
                                            <code>plink --bfile kggseq.merged --genome</code>
                                            The following is the reference genotypes integrated by KGGSeq: (KGGSeq will automatically download it for you according to the set name specified by <tt>--db-merge</tt> )<br />

                                            <table class="list">
                                                <tr >
                                                    <th >Reference genotype set</th>
                                                    <th >Description</th>
                                                </tr>
                                                <tr >
                                                    <td >hapmap2.r22.ceu.hg19</td>
                                                    <td rowspan="3">
                                                        <span>
                                                            Haplotypes of Hapmap 2 release 22. Convert the coordinates to be hg19 from hg18 by UCSC lift over function. Complied from
                                                            <a href="http://www.sph.umich.edu/csg/abecasis/MACH/download/HapMap-r22.html" target="_blank">here</a>.
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr >
                                                    <td >hapmap2.r22.chbjpt.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td >hapmap2.r22.yri.hg19</td>
                                                    <td ></td>
                                                </tr>
                                                <tr >
                                                    <td>hapmap3.r2.ceu.hg19</td>
                                                    <td rowspan="5">
                                                        <span>
                                                            Haplotpyes of Hapmap 3 release 2. Convert the coordinates to be hg19 from hg18 by UCSC lift over function. Compiled from
                                                            <a href="http://www.sph.umich.edu/csg/abecasis/MACH/download/HapMap3.r2.b36.html" target="_blank">here</a>.
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr >
                                                    <td>hapmap3.r2.chbjpt.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>hapmap3.r2.mex.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>hapmap3.r2.tsi.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>hapmap3.r2.yri.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase1.v3.shapeit2.asn.hg19</td>
                                                    <td rowspan="4">
                                                        Haplotpyes of 1000 Genomes Project version 3. Donwload from
                                                        <a href="http://www.sph.umich.edu/csg/abecasis/MACH/download/1000G.2012-03-14.html" target="_blank">here</a>.
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase1.shapeit2.v3.eur.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td >1kg.phase1.shapeit2.v3.afr.hg19</td>
                                                    <td ></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase1.v3.shapeit2.amr.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase3.v5.shapeit2.eur.hg19</td>
                                                    <td rowspan="5">
                                                        Haplotpyes of 1000 Genomes Project Phase3 of version 5. Donwload from
                                                        <a href="ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20130502/" target="_blank">here</a>.

                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td >1kg.phase3.v5.shapeit2.afr.hg19</td>
                                                    <td ></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase3.v5.shapeit2.amr.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase3.v5.shapeit2.sas.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>1kg.phase3.v5.shapeit2.eas.hg19</td>
                                                    <td></td>
                                                </tr>
                                                <tr><td colspan="2">We acknowledge the complied VCF data of 1000 Genomes projects by the author of MACH, Dr. LI Yun. To see detailed the description about the data,
                                                        please visit<br><a href="http://www.sph.umich.edu/csg/abecasis/MACH/download/1000G.2012-03-14.html" target="_blank">http://www.sph.umich.edu/csg/abecasis/MACH/download/1000G.2012-03-14.html</a></td></tr>
                                            </table>  <br />
                                            An unexpectedly high pair-wise relatedness (denoted by the PI_HAT of plink) suggests cross-individual contamination<br>
                                                <br />
                                                <strong>Note</strong> To estimate the relatedness (the PI_HAT), you normally do NOT need the genotypes datasets from 1000 Genome Projects (which will require rather large memory). The merging with ancestry-matched HapMap genotype data is often sufficient for an accurate estimation of relatedness. However, the estimation of PI_HAT without reference genotypes in a small local sample will result in an over-estimated value because of the inaccurate allele frequencies derived from the tiny sample.
                                                <code>plink --bfile kggseq --mendel</code>
                                                <code>plink --bfile kggseq --check-sex</code>
                                        </p>
                                        Secondly, we provide plotting function (see Plotting part) to visualization the distribution of minor alleles per individual. The outlier from the distribution of total rare variants (MAF < 0.01, or novel in the common database) across all individuals can be easily detected and then ignored in the following analysis.
                                        <p><code>java -jar kggseq.jar --vcf-file path-to-file1 --out path/to/prefixname --mafplot</code>
                                            <code>java -jar kggseq.jar --vcf-file path-to-file1 --ped-file path/to/file2  --db-filter hg18_dbsnp138,hg18_dbsnp141 --allele-freq 0,0.01 --o-vcf path/to/file3</code></p>
                                        <p><strong>Note</strong> The meanings for <tt>-db-filter</tt> and <tt>--allele-freq</tt> in this section are provied in  "<a href="#AlleleFrequencyTrimming" target="_self">Allele Frequency Trimming</a>" section.</p>
                                        <p>&nbsp;</p>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <h2><a  id="FilteringAndPrioritization" >Filtering</a></h2><hr />
                                    KGGSeq offers  simple but potentially powerful strategies to variants filtering and prioritization, which help users isolate most promising disease causal candiate variants from sequence variants to be considered.Users could prioritize variants based on some or all of the following evidences and/or functions: Genetic inheritance sharing, gene feature, allele frequency,  biological function prediction, sequence variant type, and phenotype-relevant filtering.
                                    <h3><a  id="GeneticInheritanceSharing" > Genetic inheritance sharing</a></h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Inheritance pattern filter: <tt>--genotype-filter</tt></p>

                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2  --genotype-filter 1,2</code></p>
                                    <p>Filter out variants for which their genotypes are not consistent with the assumption of disease inheritance pattern. </p>
                                    Functions and applicable models for each code of <tt> '--genotype-filter'</tt>options are listed below:
                                    <table   class="list">
                                        <tr>
                                            <td valign="top"><b>Code</b></td>
                                            <td valign="top"><b>Function</b></td>
                                            <td valign="top"><b>Applicable model</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">1</td>
                                            <td valign="top">Exclude variants at which affected subjects have heterozygous genotypes.</td>
                                            <td valign="top">Recessive</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">2</td>
                                            <td valign="top">Exclude variants at which both affected and unaffected subjects have the same homozygous genotypes.</td>
                                            <td valign="top">Recessive and full penetrance causal mutation(s) in the sample; <b>compound-heterozygosity</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">3</td>
                                            <td valign="top">Exclude variants at which affected subjects have reference homozygous genotypes.</td>
                                            <td valign="top">Dominant without consanguineous mating </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">4</td>
                                            <td valign="top">Exclude variants at which both affected and unaffected subjects have the same heterozygous genotypes.</td>
                                            <td valign="top">Dominant with full penetrance causal mutation(s) in the sample</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">5</td>
                                            <td valign="top">Exclude variants at which affected subjects have alternative homozygous genotypes.</td>
                                            <td valign="top">Dominant  without heterogeneity</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">6</td>
                                            <td valign="top">Exclude variants at which affected family members have NO shared alleles.</td>
                                            <td valign="top">Full penetrance causal mutation(s) in the sample</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">7</td>
                                            <td valign="top">ONLY include variants at which an offspring has one or two non-inherited alleles.
                                                <br />
                                                <br />
                                                <strong>Note</strong>
                                                Used as <tt> --genotype-filter 4,7 </tt> to filter out the de novo mutations where both affected and unaffected subjects have the same heterozygous genotypes. <br />
                                                <strong>Note</strong>  Used as <tt> --ignore-homo  </tt> to ignore the  de novo mutations where affected and unaffected subjects have the same ALTERNATIVE homozygous genotypes.

                                            </td>
                                            <td valign="top">Detect <I>de novo</I> mutations which have nearly full penetrance.<br />
                                                In the main output file, there is a column named <B>DenovoMutationEvent</B> to record the genotypes of a child and his or her parents.<br />
                                                <br />
                                                Example: <I>N140_0:0/1:46,59&N140_1:0/0:57,0&N140_2:0/0:68,0</I><br />
                                                The child N140_0 has genotype 0/1 with 46 and 59 reads carrying reference alleles and alternative alleles respectively. The father N140_1 and mother N140_2 are homozygous 0/0.
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">8</td>
                                            <td valign="top">ONLY include variants at which 1) the paired non-tumor (unaffected) and tumor (affected) samples have different genotypes.<br />
                                                <br />
                                                <strong>Note</strong> The tag <tt> --indiv-pair </tt> has to be used together to specify the matched non-tumor and tumor samples, e.g.<br />  <tt> --indiv-pair tumorIndivID1:normalIndivID1,tumorIndivID2:normalIndivID2</tt>
                                            </td>
                                            <td valign="top">Detect <I>somatic mutation(s) </I> among matched tumor and non-tumor samples. </td>
                                        </tr>
                                    </table>
                                    <strong>Note</strong> Multiple filtration codes have logical OR relationship.<br /><br />
                                    <strong>Note</strong> The inheritance mode based filtration is proposed under strong assumptions for rare Mendelian disease with clear inheritance mode. If the inheritance mode is elusive, such filtration is not suggested as it may lead to the miss of genuine causal mutation(s). This is particularly true when one has no sufficient information to distinguish the <a href="http://en.wikipedia.org/wiki/Compound_heterozygosity" target="_blank"><b>compound-heterozygosity</b></a> diseases from the <a href="http://en.wikipedia.org/wiki/Recessive" target="_blank"><b>recessive</b></a> diseases.

                                    <p><img src="imgs/leaf.gif" width="10" height="8" />  Extract mutations affecting both copies of a gene in a diploid: <tt>--double-hit-gene-trio-filter</tt> or <tt>--double-hit-gene-phased-filter</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --db-gene refgene --gene-feature-in 0,1,2,3,4,5,6 --db-filter 1kg201204,dbsnp137,ESP6500AA,ESP6500EA  --rare-allele-freq 0.033 --db-score dbnsfp --mendel-causing-predict all --double-hit-gene-trio-filter (OR --double-hit-gene-phased-filter)</code></p>
                                    <p>This function is designed for a disorder suspected to be under compound-heterozygous or recessive inheritance mode, in which both copies of a gene on the two homologous chromosomes of a patient are damaged by two different mutations or the same mutation. For recessive mode, it simply checks variants with homozygous genotypes in patients. For the compound-heterozygous mode, it can use two different input data, <b>phased genotypes of a patient</b> or  <b>unphased genotypes in a trio</b>. Here the trio refers to <b>the two parents and an offspring</b>.  When these alleles causing a disease at one locus, it follows the <a href="http://en.wikipedia.org/wiki/Recessive" target="_blank"><b>recessive</b></a> model; and when they are at two loci, it follows the <a href="http://en.wikipedia.org/wiki/Compound_heterozygosity" target="_blank"><b>compound-heterozygosity</b></a> model. In both cases, a gene is hit twice. This is the reason why it has the name 'double-hit gene'. </p>
                                    <p>Besides the file storing prioritized sequence variants, this analysis with <tt>--double-hit-gene-trio-filter</tt> option will lead to a list of double-hit genes in at least one subject. The counts of double-hit genes of each subject are saved in *.doublehit.gene.trios.flt.count.xls (or *.doublehit.gene.trios.flt.count.txt) and the genotypes of involved sequence variants are saved in *.doublehit.gene.trios.flt.gty.xls (or *.doublehit.gene.trios.flt.gty.txt).  The corresponding files produced by the analysis with <tt>--double-hit-gene-phased-filter</tt> option are  *.doublehit.gene.phased.flt.count.xls (or *.doublehit.gene.phased.flt.count.txt) and  *.doublehit.gene.phased.flt.gty.xls (or *.doublehit.gene.phased.flt.gty.txt).</p>
                                    <p><strong>Note</strong> The <tt>--double-hit-gene-trio-filter</tt> or <tt>--double-hit-gene-phased-filter</tt> only works for inputs specified by  <tt>--vcf-file</tt> and requires parents' genotypes to infer the phases of the alleles. And sequence variants with missed parents' genotypes are ignored.</p>
                                    <p><strong>Note</strong> To ignore homozygous mutation (i.e., implicating the autosomal recessive model), please add the tag <tt>--ignore-homo</tt>. </p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" />  Extract a gene on which EVERY affected subject has at least one case-unique alternative allele. But these alleles may be from different variants: <tt>--unique-gene-filter</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --db-filter 1kg201204,dbsnp137,ESP6500AA,ESP6500EA  --rare-allele-freq 0.02 --db-score dbnsfp --mendel-causing-predict all --unique-gene-filter</code></p>
                                    <p>Sequence variants beyond this type of genes will be filtered out.</p>
                                    <p><strong>Note</strong> <tt>--unique-gene-filter</tt> only works for inputs specified by  <tt>--vcf-file</tt>.</p>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Filter sequence variants by Identical by state (IBS): <tt>--ibs-case-filter X</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --ibs-case-filter X </code></p>
                                    <p>Search the longest region (in minimal length X kb) of each interesting variant, in which there is at least one allele identical among all cases. This function can be used to highlight potential causal mutations or exclude non-disease-relevant sequence variants as the causal mutation(s) is very likely to have long shared regions among all affected family members of Mendelian dominant and recessive diseases. However, IBS checking is just a quick but over-estimation of <a href="http://en.wikipedia.org/wiki/Identity_by_descent" target="_blank">identical by descent (IBD)</a>, which is a more accurate measure of shared regions among related individuals. KGGSeq currently has no function to estimate IBD regions but allow users to input the IBD information estimated by third-party tools into KGGSeq for annotation.
                                    </p>
                                    <p><strong>Note</strong> <tt>--ibs-case-filter</tt> only works for inputs specified by  <tt>--vcf-file</tt>.</p>


                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Identical by descent (IBD) annotation: <tt>--ibd-annot</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --ibd-annot path/to/file3</code></p>
                                    <p>User can also provide <b>IBD</b> (i.e.,  the two alleles arose from the same allele in an earlier generation) or  significant linkage regions, which are estimated by a third party statistical genetics tools (such as <a href="http://faculty.washington.edu/browning/beagle/beagle.html" target="_blank">BEAGLE</a>, <a href="http://www.sph.umich.edu/csg/abecasis/Merlin/index.html" target="_blank">Merlin</a> and <a href="http://www.genetics.ucla.edu/software/simwalk_doc/SW2_Overview.html" target="_blank">SimWalk2</a>). Variants within these regions will be highlighted. For an ibd or linkage annotation file, title line is needed, and the  file format is like: </p>
                                    <h4>
                                        CHR	START	END<br />
                                        1	6134174 	10082841<br />
                                        1	202855724	207862411<br />
                                        <hr />
                                        <strong>Note</strong> Title line is needed.
                                    </h4>
                                    <P> </p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" />  Filter sequence variants by homozygosity: <tt>--homozygosity-case-filter X</tt></p>
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --homozygosity-case-filter X</code></p>
                                    <p>
                                        Search the longest region (in minimal length X kb) of consecutive <a href="http://en.wikipedia.org/wiki/Zygosity#Homozygous" target="_blank"><b>homozygous</b></a> genotype for each interesting variant with minimal length X kb in cases but not in controls. For cancer diseases, this function can be used to examine the <a href="http://en.wikipedia.org/wiki/Loss_of_heterozygosity" target="_blank">loss of heterozygosity</a> straightforwardly. For rare recessive diseases, it can be used to examine the  <a href="http://www.orcades.ed.ac.uk/popgenetics/homozygosity.html" target="_blank">runs of homozygosity</a>  straightforwardly. But KGGSeq currently does not have methods to test the statistical significance.
                                    </p>
                                    <p><strong>Note</strong> <tt>--homozygosity-case-filter</tt> only works for inputs specified by  <tt>--vcf-file</tt>.</p>
                                    <h3><a  id="GeneFeatureFiltering" > Gene feature filtering</a> </h3>
                                    <p>Filtration according to gene features:  <tt> --db-gene & --gene-feature-in</tt></p>
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --db-gene refgene,gencode,knowngene --gene-feature-in 0,1,2,3,4,5,6</code></p>
                                    <p>The <tt>'--dbgene'</tt> sets database(s) to annotate and filter variants.</p>

                                    <table class="list">
                                        <tr>
                                            <td valign="top"><b>Gene database label</b></td>
                                            <td valign="top"><b>Supported reference genome</b></td>
                                            <td valign="top"><b>Description</b></td>
                                            </b>
                                        </tr>
                                        <tr>
                                            <td valign="top">refgene</td>
                                            <td valign="top">hg18, hg19 and hg38</td>
                                            <td valign="top">The RefGene database compiled by UCSC from <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/refGene.txt.gz">hg18 refGene</a> and <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/refGene.txt.gz">hg19 refGene</a>
                                                <br />  Note: RefSeq has NO mitochondria gene definition.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">gencode</td>
                                            <td valign="top">hg19 and hg38</td>
                                            <td valign="top">The GENCODE gene sets.See <a href="http://www.gencodegenes.org/">home page </a> and the <a href="http://genome.cshlp.org/content/22/9/1760.abstract">paper</a> of GENCODE for details.
                                                <br /> Note: GENCODE contains similar number of coding genes but more transcripts than RefGene. It HAS the mitochondria gene definition.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">knowngene</td>
                                            <td valign="top">hg18, hg19 and hg38</td>
                                            <td valign="top">The UCSC knonwGene database compiled by UCSC from <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/knownGene.txt.gz">hg18 knownGene</a> and <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/knownGene.txt.gz">hg19 knownGene</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">ensembl</td>
                                            <td valign="top">hg19 and hg38</td>
                                            <td valign="top">The Ensembl gene database compiled by UCSC from <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/ensGene.txt.gz">hg19 ensGene</a>
                                            </td>
                                        </tr>
                                    </table>
                                    <p>  With this filter, variants beyond <tt> '--gene-feature-in' </tt> region will be excluded. It is <tt> '--gene-feature-in 0,1,2,3,4,5...,15' </tt> by default.</p>
                                    Illustration of number codes for the gene features:

                                    <table class="list">
                                        <tr>
                                            <td valign="top"><b>Feature</b></td>
                                            <td valign="top"><b>Code</b></td>
                                            <td valign="top"><b>Explanation</b></td>
                                            </b>
                                        </tr>
                                        <tr>
                                            <td valign="top">Frameshift</td>
                                            <td valign="top">0</td>
                                            <td valign="top">Short insertion or deletion result in a completely different translation from the original.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Nonframeshift</td>
                                            <td valign="top">1</td>
                                            <td valign="top">Short insertion or deletion results in loss of amino acids in the translated proteins.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Startloss</td>
                                            <td valign="top">2</td>
                                            <td valign="top">Indels or nucleotide substitution result in the loss of start codon(ATG) (mutated into a non-start codon).</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Stoploss</td>
                                            <td valign="top">3</td>
                                            <td valign="top">Indels or nucleotide substitution result in the loss of stop codons (TAG, TAA, TGA)</td>
                                        </tr>

                                        <tr>
                                            <td valign="top">Stopgain</td>
                                            <td valign="top">4</td>
                                            <td valign="top">Indels or nucleotide substitution result in the new stop codons (TAG, TAA, TGA), which may truncate the protein.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Splicing</td>
                                            <td valign="top">5</td>
                                            <td valign="top">variant is within 2-bp of a splicing junction (use --splicing x to change this, the unit of x is base-pair)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Missense</td>
                                            <td valign="top">6</td>
                                            <td valign="top">Variants result in a codon coding for a different amino acid (missense)</td>
                                        </tr>                                       
                                        <tr>
                                            <td height="22" valign="top">Synonymous</td>
                                            <td valign="top">7</td>
                                            <td valign="top">Nucleotide substitution does not change amino acid.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Exonic</td>
                                            <td valign="top">8</td>
                                            <td valign="top">Due to loss of sequences in reference database, this variant can only be mapped into exonic region without more precise annotation.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">UTR5</td>
                                            <td valign="top">9</td>
                                            <td valign="top">Within a 5' untranslated region</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">UTR3</td>
                                            <td valign="top">10</td>
                                            <td valign="top">Within a 3' untranslated region</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Intronic</td>
                                            <td valign="top">11</td>
                                            <td valign="top">Within an intron</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Upstream</td>
                                            <td valign="top">12</td>
                                            <td valign="top">Within 1-kb region upstream of transcription start site (use --neargene x to change this, the unit of x is base-pair)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Downstream</td>
                                            <td valign="top">13</td>
                                            <td valign="top">Within 1-kb region downtream of transcription end site (use --neargene x to change this, the unit of x is base-pair)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">ncRNA</td>
                                            <td valign="top">14</td>
                                            <td valign="top">Within a transcript without protein-coding annotation in the gene definition (see Notes below for more explanation)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Intergenic</td>
                                            <td valign="top">15</td>

                                            <td valign="top">variant is in intergenic region</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Monomorphic</td>
                                            <td valign="top">16</td>
                                            <td valign="top">It is not a sequence variation actually, which may be resulted from bugs in reference genome in variant calling. </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">Unknown</td>
                                            <td valign="top">17</td>
                                            <td valign="top">Variants has no annotation.</td>
                                        </tr>
                                    </table>

                                    The output of this function is a list of variables providing all involved gene features of a considered variant.
                                    <h4>
                                        <b> MostImportantFeatureGene: </b>The gene corresponds to the variant&rsquo;s smallest gene feature code.<br />
                                        <b> MostImportantGeneFeature: </b>The variant&rsquo;s smallest gene feature code.<br />
                                        <b> RefGeneFeatures: </b>All matched gene features in the reference gene database.<br />
                                        <b> GENCODEFeatures: </b>All matched gene features in the GENCODE gene database. 
                                    </h4>
                                    <br />
                                    <br />
                                    The gene feature annotations are described in accordance with the <a href="http://www.hgvs.org/mutnomen/examplesDNA.html" target="_blank"><b>Human Genome Variation Society (HGVS) recommendations</b></a>. The followings are some examples:
                                    <h4>
                                        <i>KLHL17:NM_198317:c.1918A>C:p.T640P:(12Exons):exon12:missense</i><br />	
                                        <b>Means: At nucleotide 76 of gene KLHL17's transcript NM_198317, an A is changed to a C, which changes the 640<sup>th</sup> amino-acid T to be P in this transcript's protein. This transcript has 12 exons in total and this variant is in the 12<sup>th</sup> exon.</b><br />								
                                        <i>DNAJC8:NM_014280:c.237+2T>G:(9Exons):exon3GTdonor</i><br />
                                        <b>Means:This is a T to G substitution of the 2<sup>nd</sup> nucleotide of the 2 <sup>nd</sup> intron  (from its 5' part) positioned between coding DNA nucleotides 237 and 238, which will affect the GT splicing donor.</b><br />
                                        <i>HNRNPCL2:NM_001136561:c.-169C>G:(2Exons):5UTR</i><br />
                                        <b>Means: This is a C to G substitution of nucleotide, 169 nucleotides upstream of the ATG translation initiation codon (coding DNA -169).</b><br />										 
                                        <i>PRAMEF4:NM_001009611:c.*62C>T:(4Exons):3UTR</i><br />
                                        <b>Means: This is a C to T substitution of nucleotide coding DNA 62, located in the 3' UTR.</b><br />
                                        <i>C1orf159:NM_017891:c.311-23T>C:(10Exons):intronic6</i><br />	
                                        <b>Means: This is a T to C substitution of the 23 nucleotide of the 6 <sup>th</sup> intron  (from its 3' part) positioned between coding DNA nucleotides 310 and 311.</b><br />                                        
                                        <i>HNRNPCL1:NM_001013631:c.*138G>A:(2Exons):downstream</i><br />
                                        <b>Means: This is a C to A substitution of nucleotide located 293 nucleotides downstream of the gene, i.e. the polyA-addition site.</b><br />
                                        <i>TNFRSF18:NM_148901:c.-61C>T:(4Exons):upstream</i><br />										
                                        <b>Means: This is a C to T substitution of nucleotide, 61 nucleotides upstream of the ATG translation initiation codon (coding DNA -61).</b><br />                                        
                                    </h4>


                                    <h3><a  id="AlleleFrequencyTrimming" > Allele frequency trimming by 4 ways</a> </h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> <b>1. </b> Allele frequency trimming according to  database: <tt> --db-filter </tt> </p>
                                    <code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2  --db-filter 1kg201204,dbsnp141,ESP6500AA,ESP6500EA  --rare-allele-freq 0.005 --db-filter-hard dbsnp138nf</code>
                                    This mode enables  variants filtering according to allele frequencies recorded in public data sources. <br />
                                    The <tt>'--db-filter' </tt>is use to set databases for filtration. In the above case, variants with alternative allele frequency EQUAL to or over 0.005 will be excluded. <b>No spaces </b> are allowed between and within database names.
                                    <br />
                                    Moreover, <tt>'--db-filter-hard' </tt>is use to filter <b>ALL</b>  existing  variants in a database. But it should be always careful to use this hard filtering.
                                    <br />
                                    <br />
                                    List of public databases for allele frequency trimming

                                    <table  class="list">
                                        <tr>
                                            <td valign="top"><b>Genome Build</b></td>
                                            <td valign="top"><b>DB Label</b></td>
                                            <td valign="top"><b>Explanation</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kg201305</td>
                                            <td valign="top">All sample of 1000 Genomes Project released 2013 May (over 81 million sequence variants from 2504 subjects)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgasn2010</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs + indels (2010 March call set) for ASN (asian)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgeur2010</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs + indels (2010 March call set) for EUR (european)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgafr2010</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs + indels (2010 March call set) for AFR (african)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgasn2009</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs (2009 April call set) for ASN (asian)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgeur2009</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs (2009 April call set) for EUR (european)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">1kgafr2009</td>
                                            <td valign="top">1000 Genomes Project Pilot Data SNPs (2009 April call set) for AFR (african)</td>
                                        </tr>

                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">dbsnp137</td>
                                            <td valign="top">dbSNP version 137,compiled from UCSC with coordinates converted by liftover.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">dbsnp138</td>
                                            <td valign="top">dbSNP version 138, compiled from UCSC with coordinates converted by liftover.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">dbsnp138nf</td>
                                            <td valign="top">dbSNP version 138 without the flagged SNPs by UCSC (so nonflagged: nf). In UCSC the flagged SNPs include SNPs clinically associated by dbSNP, mapped to a single location in the reference genome assembly, and not known to have a minor allele frequency of at least 1%. The coordinates were converted from hg19 to hg18 by liftover.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">dbsnp141</td>
                                            <td valign="top">dbSNP version 141, compiled from NCBI dbSNP V141. Note Indels are ingored.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg18</td>
                                            <td valign="top">ESP5400</td>
                                            <td valign="top">a public variants dataset from NHLBI GO Exome Sequencing Project (<a href="http://evs.gs.washington.edu/EVS/" target="_blank">ESP</a>)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kg201305</td>
                                            <td valign="top">All sample of 1000 Genomes Project release 2013 May (over 81 million sequence variants from 2504 subjects)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kg201204</td>
                                            <td valign="top">All sample of 1000 Genomes Project release 2012 April </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kgafr201204</td>
                                            <td valign="top">African descendent samples of 1000 Genomes Project release in 2012 April </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kgeur201204</td>
                                            <td valign="top">European descendent samples of 1000 Genomes Project release in 2012 April </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kgamr201204</td>
                                            <td valign="top">American descendent samples of 1000 Genomes Project release in 2012 April </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">1kgasn201204</td>
                                            <td valign="top">Asian descendent samples of 1000 Genomes Project release in 2012 April </td>
                                        </tr>

                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">dbsnp135</td>
                                            <td valign="top">dbSNP version 135, compiled from UCSC.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">dbsnp137</td>
                                            <td valign="top">dbSNP version 137, compiled from UCSC.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">dbsnp138</td>
                                            <td valign="top">dbSNP version 138, compiled from UCSC.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">dbsnp138nf</td>
                                            <td valign="top">dbSNP version 138 without the flagged SNPs by UCSC (so nonflagged: nf). In UCSC the flagged SNPs include SNPs clinically associated by dbSNP, mapped to a single location in the reference genome assembly, and not known to have a minor allele frequency of at least 1%. </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">dbsnp141</td>
                                            <td valign="top">dbSNP version 141, compiled from NCBI dbSNP V141. Note Indels are ingored.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">ESP5400</td>
                                            <td valign="top">a public variants dataset from NHLBI GO Exome Sequencing Project (<a href="http://evs.gs.washington.edu/EVS/" target="_blank">ESP</a>)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">ESP6500AA</td>
                                            <td valign="top">a public variants dataset of African American from NHLBI GO Exome Sequencing Project (<a href="http://evs.gs.washington.edu/EVS/" target="_blank">ESP</a>)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">ESP6500EA</td>
                                            <td valign="top">a public variants dataset of European American from NHLBI GO Exome Sequencing Project (<a href="http://evs.gs.washington.edu/EVS/" target="_blank">ESP</a>)</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">hg19</td>
                                            <td valign="top">exac</td>
                                            <td valign="top"> <a href="http://exac.broadinstitute.org/" target="_blank">Exome Aggregation Consortium (ExAC)</a>: Variants from 61,486 unrelated individuals sequenced as part of various disease-specific and population genetic studies (<a href="http://evs.gs.washington.edu/EVS/" target="_blank">ESP</a>)</td>
                                        </tr>
                                    </table>

                                    The output of this function is a list of variables providing all involved gene features of a considered variant.
                                    <h4>
                                        <b> MaxDBAltAF: </b>The maximum alternative allele frequency across datasets specified.<br />
                                        <b> altFreq@hgXX_XXXXX: </b>The alternative allele frequency at a dataset hgXX_XXXXX.<br />
                                        <strong>Note</strong>Variants without allele frequencies in reference databases are marked by '.' in the results. Moreover, Variants not EXISTING in reference database are marked by 'N'.
                                    </h4>

                                    <br />
                                    <img src="imgs/leaf.gif" width="10" height="8" /> <b>2. </b> Users can also provide local filters to filter variants. <tt> --local-filter</tt><br />
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2   --local-filter path/to/file3  --rare-allele-freq 0.005 --local-filter-hard path/to/file4</code></p>

                                    Moreover, <tt>'--local-filter-hard' </tt>is use to filter <b>ALL</b>  existing variants in a database.

                                    <p>The <tt>'--local-filter'</tt> option sets local datasets for filterating. KGGSeq accepts local dataset files in the following format: each file has 5 columns [Chromosome, Physical Position, Reference Allele, Alternative Allele(s), and Frequency of alternative allele(s)], separated by tab character. KGGSeq provides a function to convert data in VCF format to that in the local dataset format:</p>
                                    <code>java -jar ./kggseq.jar --make-filter --vcf-file path/to/file --buildver-in hg18 --out test.hg18.var --buildver-out hg19</code>

                                    An example file is like:
                                    <h4>

                                        Chrom	Position	Reference	Alternative	Freq<br />
                                        1	469	C	G	0.150<br />
                                        1	492	C	T	0.175<br />
                                        1	519	G	C	0.067<br />
                                        1	874290	-	0ACAGAG	0.809<br />
                                        1	875913	CAG	3	0.8431<br />
                                        <hr />
                                        <strong>Note</strong> The title line is needed and Freq is optional.
                                    </h4>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> <b>3. </b> An in-house VCF file can be used for allele frequency trimming: <tt>--local-filter-vcf </tt></p>
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2   --local-filter-vcf path/to/file3  --rare-allele-freq 0.005 --local-filter-vcf-hard path/to/file4</code></p>
                                    <p> If the data were stored in different files chromosome by chromosome, you can use <tt>' _CHROM_'</tt> to denote the chromosome names [1...Y] or directly specify [1,2,X] in the file name so that kggseq can read data in multiple files in a run.</p>

                                    Similarly, <tt>'--local-filter-vcf-hard' </tt>is use to filter <b>ALL</b>  existing variants in a database.

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> <b>4. </b>An in-house VCF file without genotypes can also be used for allele frequency trimming: <tt>--local-filter-no-gty-vcf </tt></p>
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2   --local-filter-no-gty-vcf path/to/file3  --rare-allele-freq 0.005 --local-filter-no-gty-vcf-hard path/to/file4</code></p>

                                    Similarly, <tt>'--local-filter-no-gty-vcf-hard' </tt>is use to filter <b>ALL</b>  existing variants in a database.
                                    <p> <strong>Note</strong>1. To remove variants in database regardless of their frequencies, please use  <tt>'--rare-allele-freq 0'</tt>.  <br />
                                        <strong>Note</strong>2. To keep variants in a frequency range,[a,b], please use  <tt>'--allele-freq a,b'</tt> option. The boundaries a and b are included.  <br />
                                        <strong>Note</strong>3. The options, <tt>'--allele-freq' </tt>and <tt>'--rare-allele-freq'</tt>, are mutually exclusive and the latter has higher priority.</p>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> <b>5. </b>Filter variants by minor allele frequency in the input sample: <tt>--filter-sample-maf-less</tt> or <tt>--filter-sample-maf-over</tt></p>
                                    <p><code>java -jar ./kggseq.jar  --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2  --filter-sample-maf-less 0.01</code></p>

                                    <tt>--filter-sample-maf-less</tt>: Filter out variants with minor allele frequency less than a cutoff (x) in the input samples.<br/>
                                    <tt>--filter-sample-maf-over</tt>: Filter out variants with minor allele frequency over a cutoff (x) in the input samples.<br/>



                                    <h3><a  id="VariantTypeAndRegionFiltering" >  Variant type, region and gene filtering</a> </h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Ingore insertion and deletion sequence variants (indels): <tt> --ignore-indel</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --ignore-indel</code></p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" />  Accordingly, users can also  ask kggseq to  ingore Single nucleotide variants (SNVs) : <tt> --ignore-snv</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --ignore-snv</code></p>
                                    <p>By default, KGGSeq will process both SNV and Indel.
                                    </p>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Ignore some genomic regions: <tt>--regions-out</tt> </p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --regions-out chrX,chrY:1-10000</code>
                                        <img src="imgs/leaf.gif" width="10" height="8" />  Alternatively, one can also exclusively process sequence variants at some genome regions:
                                        <code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --regions-in chr2,chr4:21212-233454</code> </p>


                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Ignore variants within some genes: <tt>--genes-out</tt> </p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --genes-out TCF4,CNNM2,ANK3</code>
                                        <img src="imgs/leaf.gif" width="10" height="8" />  Alternatively, one can KEEP variants only within some genes:
                                        <code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --genes-in TCF4,CNNM2,ANK3</code> </p>


                                    <h3><a  id="SupperDuplicateRegionFiltering" > Super duplicate region filtering</a> </h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Filter out variants in super duplicate regions: <tt>--superdup-filter</tt> </p>
                                    <code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 --superdup-filter</code>
                                    <p> KGGSeq can eliminate sequence variants within putative super-duplicate genomic regions defined in a dataset (genomicSuperDups) from <a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/" target="_blank">UCSC datasets </a>, which have higher genotyping error rate. (See<a href="http://blog.goldenhelix.com/?p=1153" target="_blank"> more </a> ).

                                    </p>
                                    <p><strong>Note</strong> Anoher option <tt>--superdup-annot</tt> allows you to just mark (but not to remove) the variants in the super duplicate regions. A column named <b>SuperDupKValue</b> will be added in the resulting dataset</p>

                                    <h3><a  id="TooManyVarGeneFiltering" >Gene&#39;s Variant number</a> </h3>
                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Filter out genes with too many variants: <tt>--gene-var-filter</tt> </p>
                                    <code>java -jar ./kggseq.jar --buildver hg19 --vcf-file path/to/file1 --ped-file path/to/file2 [options to filter out common and neutral variants] --gene-var-filter 4</code>
                                    After a number of hard-filtering by allele frequencies and pathogenic prediction, you may see some genes harboring candidate variants.  Empirically, these genes are usually not interesting and their mutations are often produced by some unknown factors such pseudogene  or platform bias.  As a rule of thumb, it is safe to set a cutoff 4 or more.

                                    <h3><a  id="PhenotypeRelevantFiltering" >Case-control Phenotype</a> </h3>
                                    <br />
                                    <img src="imgs/leaf.gif" width="10" height="8" /> Filter for case or control unique variants: <tt> --filter-model case-unique</tt> or <tt> --filter-model control-unique</tt>
                                    <code>java -jar ./kggseq.jar --buildver hg19  --vcf-file path/to/file1 --ped-file path/to/file2 --filter-model case-unique </code>
                                    Case unique: extract variants with alternative alleles only present among affected individuals.<br />
                                    Control unique: extract variants with alternative alleles only present among unaffected individuals.
                                    <br />	<br />
                                    <p>
                                        <strong>Note</strong>	The <tt>--filter-model</tt>	only works for inputs specified by <tt>--vcf-file</tt> .<br />
                                        <strong>Note</strong> This function can work with  options to flexibly set the sample size and missingness of genotypes, detalied in the <a href="#VariantQC" target="_self">Variant QC</a> part.<br />

                                    </p>
                                    <p>&nbsp;                                </p>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <h2><a id="Annotation" >Annotation</a></h2>
                                    <h3><a name="FunctionalAnnotation" >Functional annotation</a></h3>
                                    <br/>
                                    Provide genomic functional annotation of variants: <tt>--genome-annot</tt><br/>
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --genome-annot</code>
                                    Currently supported functional annotation categories are Pseudogenes, transcription factor binding sites (TFBSs),  enhancers, and UniProt Feature. The option will append three extra fields to the output file:<br/>
                                    <h4>
                                        Pseudogenes: &nbsp;       &nbsp;                        Pseudogenes listed in <a href="http://tables.pseudogene.org/set.py?id=Human61">http://tables.pseudogene.org/set.py?id=Human61</a><br />
                                        DispensableDeleteriousVariants: &nbsp;       &nbsp;            Number of dispensable deleterious variants for the gene
                                        in the <a href="http://www.1000genomes.org/">1000 Genomes Project</a><br />
                                        TFBSconsSite[name:rawScore:zScore]: &nbsp;       &nbsp;        Conserved TFBSs in the <a href="http://genome.ucsc.edu/">UCSC genome browser</a><br />
                                        vistaEnhancer[name:+ve/-ve]: &nbsp;       &nbsp; Known enhancers in the <a href="http://enhancer.lbl.gov/">VISTA enhancer browser</a><br />
                                        UniProtFeature:&nbsp;       &nbsp; Annotate a variant of coding gene using the <a href="http://www.uniprot.org/manual/sequence_annotation" target="_blank">UniProt protein annotations</a>.
                                        <table class="list" >

                                            <tr>
                                                <td valign="top"><b>UniProtFeature</b></td>
                                                <td valign="top"><b>Definition</b></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">region of interest</td>
                                                <td valign="top">Extent of a region of interest in the sequence</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">active site</td>
                                                <td valign="top">Amino acid(s) involved in the activity of an enzyme.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">calcium-binding region</td>
                                                <td valign="top">Extent of a calcium-binding region.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">glycosylation site</td>
                                                <td valign="top">Glycosylation site.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">chain</td>
                                                <td valign="top">Extent of a polypeptide chain in the mature protein.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">coiled-coil region</td>
                                                <td valign="top">Extent of a coiled-coil region</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">compositionally biased region</td>
                                                <td valign="top">Extent of a compositionally biased region</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">sequence conflict</td>
                                                <td valign="top">Different papers report differing sequences.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">cross-link</td>
                                                <td valign="top">Posttranslationally formed amino acid bonds.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">disulfide bond</td>
                                                <td valign="top">Disulfide bond.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">DNA-binding region</td>
                                                <td valign="top">Extent of a DNA-binding region.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">domain</td>
                                                <td valign="top">Extent of a domain, which is defined as a specific</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">helix</td>
                                                <td valign="top">DSSP secondary structure</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">intramembrane region</td>
                                                <td valign="top"></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">initiator methionine</td>
                                                <td valign="top">Initiator methionine.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">modified residue</td>
                                                <td valign="top"></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">lipid moiety-binding region</td>
                                                <td valign="top"></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">metal ion-binding site</td>
                                                <td valign="top">Binding site for a metal ion.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">short sequence motif</td>
                                                <td valign="top">Short (up to 20 amino acids) sequence motif of      biological interest</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">mutagenesis site</td>
                                                <td valign="top">Site which has been experimentally altered.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">non-consecutive residues</td>
                                                <td valign="top">Non-consecutive residues.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">non-standard amino acid</td>
                                                <td valign="top">Non-standard aminoacid used for pyrrolysine</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">non-terminal residue</td>
                                                <td valign="top"></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">nucleotide phosphate-binding region</td>
                                                <td valign="top">Extent of a nucleotide phosphate binding region.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">peptide</td>
                                                <td valign="top">Extent of a released active peptide.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">propeptide</td>
                                                <td valign="top">Extent of a propeptide.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">repeat</td>
                                                <td valign="top">Extent of an internal sequence repetition.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">signal peptide</td>
                                                <td valign="top">Extent of a signal sequence (prepeptide).</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">site</td>
                                                <td valign="top">Any interesting single amino-acid site on the sequence.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">strand</td>
                                                <td valign="top">DSSP secondary structure</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">transit peptide</td>
                                                <td valign="top"></td>
                                            </tr>
                                            <tr>
                                                <td valign="top">topological domain</td>
                                                <td valign="top">Topological domain</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">transmembrane region</td>
                                                <td valign="top">Extent of a transmembrane region.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">turn</td>
                                                <td valign="top">DSSP secondary structure</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">unsure residue</td>
                                                <td valign="top">Uncertainties in the sequence</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">sequence variant</td>
                                                <td valign="top">Authors report that sequence variants exist.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">splice variant</td>
                                                <td valign="top">Description of sequence variants produced by alternative</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">zinc finger region</td>
                                                <td valign="top">Extent of a zinc finger region.</td>
                                            </tr>
                                            <tr>
                                                <td valign="top">binding site</td>
                                                <td valign="top"></td>
                                            </tr>
                                        </table>
                                    </h4>

                                    <br />

                                    <strong>Note</strong> Users should be aware of possible mapping error due to these pseudogenes.

                                    <h3><a name="SharedProteinProteinInteractions" >Shared protein-protein interactions (PPIs)</a></h3>
                                    <br/> Examine whether variants share the same PPIs with some genes of interest: <tt>--candi-list gene1,gene2,...,geneN --ppi-annot ppiDatabase</tt>
                                    <br/>


                                    <p><code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --candi-list gene1,gene2,...,geneN --ppi-annot string --ppi-depth 1</code></p>
                                    <p><strong>Note</strong> Currently, the only supported PPI database is <a href="http://string-db.org/">STRING</a> (i.e., <tt>string</tt>).</p>
                                    <p><strong>Note</strong> Instead of specifying the gene list using the <tt>--candi-list</tt> option, users can specify a file containing the list using the <tt>--candi-file</tt> option.</p>
                                    <p><strong>Note</strong> The maximum distance of a PPI between a specifified candidate  genes and a gene containing the potential causal variants can be adjusted using the <tt>--ppi-depth</tt> option. The defaul is <tt>--ppi-depth 1</tt>.<br/>
                                    </p>



                                    The option will append the following fields to the output file:
                                    <h4>
                                        IsWithinCandidateGene:                    Whether the variant is within a candidate gene<br />
                                        PPI:                                      PPI shared by at least one gene of interest and the gene
                                        containing the variant
                                    </h4>
                                    <h3><a name="SharedGeneSets" >Shared genesets</a></h3>
                                    <br />
                                    Examine whether variants share the same genesets with some genes of interest: <tt>--candi-list gene1,gene2,...,geneN --geneset-annot GenesetDatabase</tt>
                                    <br/>
                                    <p><code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --candi-list gene1,gene2,...,geneN --geneset-annot GeneSetDatabase</code></p>

                                    <p>Currently, users can choose between 5 geneset databases from <a href="http://www.broadinstitute.org/gsea/msigdb/collections.jsp">GSEA</a>. The following are brief descriptions of the 5 datasets COPIED from the <a href="http://www.broadinstitute.org/gsea/msigdb/collections.jsp" target="_blank">page</a> of GSEA.<br/>
                                        <table width="90%" class="list">
                                            <tr>
                                                <th width="19%" scope="col">GeneSetDatabase</th>
                                                <th width="66%" scope="col">Description</th>
                                                <th width="15%" scope="col">Version</th>
                                            </tr>
                                            <tr>
                                                <td>cano</td>
                                                <td>Gene sets from the geneset databases. Usually, these gene sets are canonical representations of a biological process compiled by domain experts. (1452 gene sets)</td>
                                                <td> MSigDB 3.1</td>
                                            </tr>
                                            <tr>
                                                <td> cura </td>
                                                <td>Curated gene sets: Gene sets collected from various sources such as online geneset databases, publications in PubMed, and knowledge of domain experts. The gene set page for each gene set lists its source. (4850 gene sets)</td>
                                                <td> MSigDB 3.1</td>
                                            </tr>
                                            <tr>
                                                <td> onco </td>
                                                <td> Oncogenic signatures: Gene sets represent signatures of cellular genesets which are often dis-regulated in cancer. The majority of signatures were generated directly from microarray data from NCBI GEO or from internal unpublished profiling experiments which involved perturbation of known cancer genes. In addition, a small number of oncogenic signatures were curated from scientific publications. (189 gene sets)</td>
                                                <td> MSigDB 3.1</td>
                                            </tr>
                                            <tr>
                                                <td> cmop </td>
                                                <td>Computational gene sets: Computational gene sets defined by mining large collections of cancer-oriented microarray data. (858 gene sets)</td>
                                                <td> MSigDB 3.1</td>
                                            </tr>
                                            <tr>
                                                <td> onto </td>
                                                <td>GO gene sets Gene sets are named by GO term and contain genes annotated by that term. GSEA users: Gene set enrichment analysis identifies gene sets consisting of co-regulated genes; GO gene sets are based on ontologies and do not necessarily comprise co-regulated genes. (1454 gene sets)</td>
                                                <td> MSigDB 3.1</td>
                                            </tr>
                                        </table>

                                    </p>
                                    <p><strong>Note</strong> The <tt>--candi-list</tt> and <tt>--candi-file</tt> options can be shared with <tt>--ppi-annot</tt>. </p>

                                    The option will append the following fields to the output file:
                                    <h4>
                                        IsWithinCandidateGene:                    Whether the variant is within a candidate gene<br />
                                        SharedGeneSet:                            GeneSet shared by at least one gene of interest and the gene
                                        containing the variant
                                    </h4>


                                    <h3><a name="TextMining" >Text mining</a></h3>
                                    <br/>
                                    <a name="PubMedTextMining" >PubMed text mining:</a><tt>--pubmed-mining searchTerm</tt> or <tt>--pubmed-mining-gene searchTerm</tt><br />
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --pubmed-mining search+Term1,search+Term2</code>
                                    KGGSeq can mine the titles and abstracts of published papers in PubMed via the NCBI <a href="http://www.ncbi.nlm.nih.gov/books/NBK25500/" target="_blank" >E-utilities</a> to find a co-mention with the searched term(s) of interest (i.e., disease) and the genes/cytogeneic regions in which the
                                    variants are located. The option <tt>--pubmed-mining</tt> will append the following two fields to the output file while the <tt>--pubmed-mining-gene</tt> will only add the <I>PubMedIDGene</I> information.
                                    <h4>
                                        PubMedIDIdeogram :                        PubMed ID of articles in which the term and the cytogeneic
                                        position of the variant are co-mentioned<br />
                                        PubMedIDGene :                            PubMed ID of articles in which the term and the gene
                                        containing the variant are co-mentioned</h4>
                                    <br />
                                    <strong>IMPORTANT</strong>  Please use + instead of blank characters within a search term.<br/>

                                    <br/>
                                    <a name="OMIMTextMining" >OMIM term annotation:</a><tt>--omim-annot</tt><br />
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --omim-annot</code>
                                    KGGSeq can extract all available disorder names linked to a gene in which the
                                    variants are located from the OMIM dataset <a href="http://www.omim.org/downloads" target="_blank" >morbidmap</a>. The command will append two extra fields to the output file:
                                    <h4>
                                        DiseaseName(s)MIMid :                        Disorder, &lt;disorder MIM no.&gt; (&lt;phene mapping key&gt;)<br />
                                        Phenotype mapping method &lt;phene mapping key&gt;:<br />
                                        1 - the disorder is placed on the map based on its association with
                                        a gene, but the underlying defect is not known.<br />
                                        2 - the disorder has been placed on the map by linkage; no mutation has
                                        been found.<br />
                                        3 - the molecular basis for the disorder is known; a mutation has been
                                        found in the gene.<br />
                                        4 - a contiguous gene deletion or duplication syndrome, multiple genes
                                        are deleted or duplicated causing the phenotype.<br />

                                        GeneMIMid :                                                    Gene/locus MIM no.
                                    </h4>
                                    <br />

                                    <br/>
                                    <a name="COSMICMining" > COSMIC cancer information: </a><tt>--cosmic-annot</tt><br />
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --indiv-pair NONTUMOR.1:TUMOR.1,NONTUMOR.2:TUMOR.2 --genotype-filter 8 --cosmic-annot</code>
                                    KGGSeq can retrieve the confirmed somatic mutation information registered for variants and genes in the <a href="http://cancer.sanger.ac.uk/cancergenome/projects/cosmic/" target="_blank" >COSMIC</a> database.
                                    The command will append a field to the output file. e.g.,
                                    <h4>
                                        COSMICCancerInfo : known cancer and occurrence time of the somatic mutation in COSMIC dataset. e.g., {serous_carcinoma=3, astrocytoma_Grade_IV=1}<br />
                                        This somatic mutation occurred 3 times in samples of 'serous_carcinoma' and once in samples of 'astrocytoma_Grade_IV'.
                                    </h4>
                                    <br />
                                    <a name="dbSNPRSID" > dbSNP RSID: </a><tt>--rsid</tt><br />
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2   --rsid</code>
                                    KGGSeq can update the variants' <a href="http://www.ncbi.nlm.nih.gov/projects/SNP/" target="_blank">dbSNP rsID </a>(if available)  according to their genomic coordinates. The resource data used are from
                                    <b>SNPChrPosOnRef</b> (<a href="ftp://ftp.ncbi.nih.gov/snp/organisms/human_9606_b142_GRCh37p13/database/organism_data/b142_SNPChrPosOnRef_105.bcp.gz">hg19</a>/<a href="ftp://ftp.ncbi.nih.gov/snp/organisms/human_9606_b142_GRCh38/database/organism_data/b142_SNPChrPosOnRef_106.bcp.gz">hg38</a>) [<a href="http://www.ncbi.nlm.nih.gov/SNP/snp_db_table_description.cgi?t=SNPChrPosOnRef">help</a>]. 
                                    <br/>
                                    <br/>
                                    <a name="splicingAnnote" >Potential of altering splicing </a><tt>--scsnv-annot</tt><br />

                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --scsnv-annot</code>
                                    Annotate a SNV with predicted potential of altering splicing from <a href="https://sites.google.com/site/jpopgen/dbNSFP" target="_blank"> dbscSNV </a>, which include all possible human SNVs within splicing consensus regions &#40;-3 to +8 at the 5  splice site and -12 to +2 at the 3&#39; splice site&#41;.
                                    <br/>                                    The command will append a field to the output file. 
                                    <h4>
                                        ada_score@dbScSNV: The prediction score by ADA approach which combines multiple existing tools. See more in <a  href="http://nar.oxfordjournals.org/content/42/22/13534" target="_blank"> Jian et al (2014)</a> <br />
                                    </h4>
                                    <p>&nbsp;</p>
                                    <h2><a id="PredictionVar" >Prediction at variant</a></h2>
                                    KGGSeq provides a series of methods to combine existing functional scores of DNA variants from multiple algorithms (i.e.,  <a href="http://sift.jcvi.org/" target="_blank">SIFT</a>, <a href="http://genetics.bwh.harvard.edu/pph2/" target="_blank">PolyPhen2</a>, <a href="https://www.sanger.ac.uk/resources/software/gwava/" target="_blank">GWAVA</a>  and <a href="http://cadd.gs.washington.edu/ " target="_blank">CADD</a>) for a more accurate pathogenic predict at coding and non-coding variants.

                                    <h3><a name="PredictingMendelianDiseaseCausingVariants" >Predicting Mendelian disease-causing variants</a></h3>
                                    <p><br/>
                                        Predict Mendelian disease-causing variants: <tt>--db-score dbnsfp --mendel-causing-predict</tt><br />
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --db-score dbnsfp --mendel-causing-predict all --filter-nondisease-variant</code>
                                        Use at most 12 available functional impact scores (listed below) collected in <a href="https://sites.google.com/site/jpopgen/dbNSFP" target="new">dbNSFP</a> database to RE-predict whether a nonsynonymous single nucleotide variant (SNV) will potentially be Mendelian disease causal or not by Logistic regression model (See methods in our paper, <a href="http://www.plosgenetics.org/article/info%3Adoi/10.1371/journal.pgen.1003143" target="_blank">Li et al. PLoS Genet. 2013 Jan;9(1):e1003143</a>). By default, KGGSeq tries all subsets of the scores (at least two) for a combinatorial prediction and finally present a prediction which can pass the threshold to classify the SNV as a potentially disease causal or no.  In conjunction with the prediction model,  the <tt>--filter-nondisease-variant</tt> tag will be used to filter out the  nondisease-causative variants predicted by Logistic regression model (See methods in <a href="http://www.plosgenetics.org/article/info%3Adoi/10.1371/journal.pgen.1003143" target="_blank">Li et al. PLoS Genet. 2013 Jan;9(1):e1003143</a>). .Note that this trying will increase the false positive rate although it decreases the false negative rate. So you may need more information to justify the involved gene(s).</p>
                                    <img src="imgs/mendelAUC.png" width="800" height="400" /><br />
                                    <b>Figure:</b> Receiver operating characteristic (ROC) and Precision recall(PR) curves and  area under the curves (AUC) of individual scores and combined score by Logistic regression model<br />
                                    Note: this is an updated plot of Figure 1 in <a href="http://www.plosgenetics.org/article/info%3Adoi/10.1371/journal.pgen.1003143" target="_blank" >our paper</a> . Here we combined more individual functional impact scores, which is the only difference.

                                    <br />
                                    <p> On the other hand, one can FIX the prediction using a specified subset or full set of the 5 impact scores by option like <tt>--mendel-causing-predict 4,6,7</tt><br />

                                        The coding for the functional impact scores used in'--mendel-causing-predict'options is listed below:                                    </p>
                                    <table  class="list">
                                        <tr>
                                            <td width="52" valign="top"><b>Coding</b></td>
                                            <td width="114" valign="top"><b>Method</b></td>
                                            <td    valign="top"><b>Description (Mostly copied from <a href="https://sites.google.com/site/jpopgen/dbNSFP" target="_blank">  dbNSFP</a>)</b></td>
                                        </tr>
                                        <tr>
                                            <td width="52" valign="top">-</td>
                                            <td width="114" valign="top"><a href="http://www.genetics.org/content/169/3/1753.abstract" target="new">SLR</a></td>
                                            <td valign="top"> Sitewise Likelihood-ratio (SLR) test statistic for testing natural selection on codons. 		A negative value indicates negative selection, and a positive value indicates
                                                positive selection. Larger magnitude of the value suggests stronger evidence.</td>
                                        </tr>
                                        <tr>
                                            <td width="52" valign="top">1</td>
                                            <td width="114" valign="top"><a href="http://www.ncbi.nlm.nih.gov/pubmed?term=22689647" target="_blank">SIFT</a></td>
                                            <td  valign="top">SIFT uses the 'Sorting Tolerant From Intolerant' (SIFT) algorithm to predict whether a single amino acid substitution affects protein function or not, based on the assumption that important amino acids in a protein sequence should be conserved throughout evolution and substitutions at highly conserved sites are expected to affect protein function.A small scoreindicates a high chance for a substitutionto damage the protein function. </td>
                                        </tr>

                                        <tr>
                                            <td width="52" valign="top">2</td>
                                            <td width="114" valign="top"><a href="http://www.ncbi.nlm.nih.gov/pubmed?term=20354512" target="new">Polyphen2_HDIV</a></td>
                                            <td  valign="top">Polyphen2 score based on HumDiv, i.e. hdiv_prob.
                                                The score ranges from 0 to 1, and the corresponding prediction is "probably damaging"
                                                if it is in [0.957,1]; "possibly damaging" if it is in [0.453,0.956]; "benign"
                                                if it is in [0,0.452]. Score cutoff for binary classification is 0.5, i.e.
                                                the prediction is "neutral" if the score is smaller than 0.5 and "deleterious" if the
                                                score is larger than 0.5. Multiple entries separated by ";"</td>
                                        </tr>
                                        <tr>
                                            <td width="52" valign="top">3</td>
                                            <td width="114" valign="top"><a href="http://www.ncbi.nlm.nih.gov/pubmed?term=20354512" target="_blank">Polyphen2_HVAR</a></td>
                                            <td  valign="top">Polyphen2 predicts the possible impact of an amino acid substitution on the structure and function of a human protein using straightforward physical and comparative considerations by an iterative greedy algorithm. In the present study, we use the original scores generated by the HumVar (instead ofHumDiv) trained model as it is preferred for the diagnosis of Mendelian diseases. The scores range from 0 to 1. A substitution with larger score has a higher possibility to damage the protein function.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">4</td>
                                            <td valign="top"><a href="http://www.ncbi.nlm.nih.gov/pubmed?term=19602639" target="_blank">LRT</a></td>
                                            <td valign="top">LRT employed a likelihood ratio test to assess variant deleteriousnessbased on a comparative genomics data set of 32 vertebrate species. The identified deleterious mutations could disrupt highly conserved amino acids within protein-coding sequences, which are likely to be unconditionally deleterious.The scores range from 0 to 1. A larger score indicates a larger deleterious effect.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">5</td>
                                            <td valign="top"><a href="http://www.ncbi.nlm.nih.gov/pubmed?term=20676075" target="_blank">MutationTaster</a></td>
                                            <td valign="top">MutationTaster assesses the impact of the disease-causing potential of a sequence variant by a naive Bayes classifier using multiple resources such as evolutionary conservation, splice-site changes, loss of protein features and changes that might affect mRNA level. The scores range from 0 to 1. The larger score suggests a higher probability to cause a human disease.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">6</td>
                                            <td valign="top"><a href="http://mutationassessor.org/" target="new">MutationAssessor</a></td>
                                            <td valign="top">MutationAssessor "functional impact of a variant :
                                                predicted functional (high, medium), predicted non-functional (low, neutral)"
                                                Please refer to Reva et al. Nucl. Acids Res. (2011) 39(17):e118 for details</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">7</td>
                                            <td valign="top"><a href="http://fathmm.biocompute.org.uk/" target="new">FATHMM</a></td>
                                            <td valign="top">FATHMM default score (weighted for human inherited-disease mutations with Disease Ontology); If a score is smaller than -1.5 the corresponding NS is predicted as &quot;D(AMAGING)&quot;; otherwise it is predicted as &quot;T(OLERATED)&quot;. If there's more than one scores associated with the same NS due to isoforms, the smallest score (most damaging) was used. Please refer to Shihab et al Hum. Mut. (2013) 34(1):57-65 for details</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">8</td>
                                            <td valign="top"><a href="http://karchinlab.org/apps/appVest.html" target="new">VEST3</a></td>
                                            <td valign="top">VEST 3.0 score. Score ranges from 0 to 1. The larger the score the more likely
                                                the mutation may cause functional change. In case there are multiple scores for the
                                                same variant, the largest score (most damaging) is presented. Please refer to
                                                Carter et al., (2013) BMC Genomics. 14(3) 1-16 for details.
                                                Please note this score is free for non-commercial use. For more details please refer to
                                                http://wiki.chasmsoftware.org/index.php/SoftwareLicense. Commercial users should contact
                                                the Johns Hopkins Technology Transfer office.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">9</td>
                                            <td valign="top"><a href="http://cadd.gs.washington.edu/" target="new">CADD_score</a></td>
                                            <td valign="top">Combined Annotation Dependent Depletion (CADD) score for funtional prediction of a SNP. Please refer to <a href="http://www.nature.com/ng/journal/v46/n3/full/ng.2892.html" target="new"> Kircher et al.
                                                    (2014) Nature Genetics 46(3):310-5  </a> for details. The larger the score the more likely
                                                the SNP has damaging effect.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">10</td>
                                            <td valign="top"><a href="http://mendel.stanford.edu/SidowLab/downloads/gerp/index.html" target="new">GERP++_NR</a></td>
                                            <td valign="top">Neutral rate</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">11</td>
                                            <td valign="top"><a href="http://mendel.stanford.edu/SidowLab/downloads/gerp/index.html" target="new">GERP++_RS</a></td>
                                            <td valign="top">RS score, the larger the score, the more conserved the site</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">12</td>
                                            <td valign="top"><a href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/phyloP100way/" target="_blank">PhyloP100way_vertebrate</a></td>
                                            <td valign="top">PhyloP estimates the evolutional conservation at each variant from multiple alignments of 100 vertebrate genomes to the human genome based on a phylogenetic hidden Markov model. </td>
                                        </tr>
                                        <tr>
                                            <td valign="top">13</td>
                                            <td valign="top"><a href="http://bioinformatics.oxfordjournals.org/content/25/12/i54.short" target="new">29way_logOdds</a></td>
                                            <td valign="top">SiPhy score based on 29 mammals genomes. The larger the score,
                                                the more conserved the site.</td>
                                        </tr>
                                    </table>
                                    <strong>Note</strong> Predictions at variants with missing scores at specified methods will be ignored!<br/>
                                    <strong>Note</strong>  If you use this feature in any published work, please cite the following manuscript:
                                    <b>Li et al. Predicting Mendelian disease-causing non-synonymous single nucleotide variants in exome sequencing studies. <span title="PLoS genetics"><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1003143" target="_blank">PLoS Genet</a></span><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1003143">. 2013 Jan;9(1):e1003143</a></b>


                                    <p>The option will append the following fields to the output file: </p>
                                    <h4>

                                        ...<br />
                                        Polyphen2_HDIV_pred:                                 Polyphen2 prediction based on HumDiv, "D" ("porobably damaging"),
                                        "P" ("possibly damaging") and "B" ("benign"). Multiple entries separated by ";"<br />

                                        Polyphen2_HVAR_pred: Polyphen2 prediction based on HumVar, "D" ("porobably damaging"),
                                        "P" ("possibly damaging") and "B" ("benign"). Multiple entries separated by ";"                                       <br />
                                        LRT_pred:                                 Classification using LRT (D = deleterious, N = neutral,
                                        or U = unknown)<br />
                                        MutationTaster_pred:                      Classification using MutationTaster (A =
                                        disease_causing_automatic, D = disease_causing, N =
                                        polymorphism, or P = polymorphism_automatic)<br />
                                        MutationAssessor_pred: MutationAssessor "functional impact of a variant :
                                        predicted functional (high, medium), predicted non-functional (low, neutral)"<br />
                                        [...]<br/>
                                        DiseaseCausalProb_ExoVarTrainedModel:     Conditional probability of being Mendelian disease-causing
                                        given the above prediction scores under a logistic regression
                                        model trained by our dataset<a href="http://statgenpro.psychiatry.hku.hk/limx/kggseq/download/ExoVar.xls" target="_blank"> ExoVar</a>.<br />
                                        IsRareDiseaseCausal_ExoVarTrainedModel:   Classification using the logistic regression model
                                        (Y = disease-causing or N = neutral)<br />
                                        BestCombinedTools:OptimalCutoff:TP:TN : The  subset of original prediction tools (out of the 13 tools) used for the combined prediction by our Logistic Regression model which have the largest posterior probability among all possible combinatorial subsets: the cutoff leads to the maximal Matthews correlation coefficient (MCC): the corresponding true positive and true negative at the maximal MCC.
                                    </h4>
                                    <strong>Note</strong> By default the option <tt>--mendel-causing-predict all </tt> is always switched on  unless other predicion types are specified.
                                    <h3><a name="PredictingCancerCausingVariants" >Predicting somatic driver mutations of cancers</a></h3>
                                    <p><br/>
                                        Predict the driver somatic-mutations and genes of cancers by an integrative methods: <tt>--db-score dbnsfp --cancer-driver-predict</tt><br />
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --indiv-pair NONTUMOR.1:TUMOR.1,NONTUMOR.2:TUMOR.2 --genotype-filter 8 --cosmic-annot --db-score dbnsfp --cancer-driver-predict all --filter-nondisease-variant</code>
                                        A driver mutation is defined as the mutation that leads to selective advantage to a cancer clone by either increasing the cancer cells' survival or reproduction. Use at most 12 available functional impact scores (listed above, exept for LRT_Omega) collected in dbNSFP database to RE-predict whether a nonsynonymous single nucleotide variant (SNV) will potentially be the somatic driver mutations or not by Logistic regression model trained under <a href="http://www.sanger.ac.uk/genetics/CGP/cosmic/" target="new">COSMIC</a> database. By default, KGGSeq tries all subsets of the scores (at least two) for a combinatorial prediction and finally present a prediction which can pass the threshold to classify the SNV as a potentially disease causal or no. In conjunction with the prediction model, the --filter-nondisease-variant tag will be used to filter out the nondisease-causative variants predicted by Logistic regression model.</p>
                                    <img src="imgs/cancerAUC.png" width="800" height="400" /><br />
                                    <b>Figure:</b> Receiver operating characteristic (ROC) and Precision recall(PR) curves and  area under the curves (AUC) of individual scores and combined score by Logistic regression model<br />

                                    <p>The option will append the following fields to the output file: </p>
                                    <h4>

                                        ...<br />
                                        <b>CancerDriverProb_COSMICTrainedModel</b>:     Conditional probability of being cancer driver mutation
                                        given the above prediction scores under a logistic regression
                                        model trained by the <a href="http://cancer.sanger.ac.uk/cancergenome/projects/cosmic/" target="_blank"> COSMIC </a>dataset.<br />
                                        <b>IsCancerDriver_COSMICTrainedModel</b>:   Classification using the logistic regression model
                                        (Y = cancer-drivering or N = passenger)<br />
                                        <b>BestCombinedTools:OptimalCutoff:TP:TN</b>: The  subset of original prediction tools (out of the 13 tools) used for the combined prediction by our Logistic Regression model which have the largest posterior probability among all possible combinatorial subsets: the cutoff leads to the maximal Matthews correlation coefficient (MCC): the corresponding true positive and true negative at the maximal MCC.<br />
                                    </h4>

                                    <p>These predicted cancer-driver somatic mutations are evaluated by our statistical approach. </p>
                                    <h4>Kwan JS, Ng OL, Sham PC and Li MX.  Functional prediction of driver mutations in cancer genomes. (In preparation)</h4>
                                    <br />


                                    <h3><a name="PredictingComplexDiseaseCausingVariants" >Predicting complex disease-causing variants</a></h3>
                                    <p>
                                        <strong>Note</strong> This feature will be available soon. Stay tuned for an update!


                                    </p>
                                    <p>&nbsp;</p>
                                </td>
                            </tr>

                            <tr>
                                <td><h2><a name="PredictionGene" >Prediction at gene </a></h2>
                                    <p>Generate a histogram of minor allele frequency (MAF) <tt>--mafplot</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --db-filter hg18_1kgasn2010,hg18_1kgeur2010,hg18_1kgafr2010,hg18_ESP5400  --allele-freq 0,1  --mafplot</code>
                                        <strong> Note</strong> Currently, --mafplot only supports the inputs specified by --vcf-file and --v-assoc-file.<br />
                                        <br />

                                        Generate a Quantile-Quantile (Q-Q) plot for association p-values <tt>--qqplot</tt>
                                        <code>java -jar kggseq.jar --v-assoc-file path/to/file --out path/to/prefixname --qqplot</code>
                                        <strong> Note</strong> Currently, --mafplot only supports the inputs specified by --assoc-file, --v-assoc-file.<br />
                                        <br />
                                    </p>
                                    <p>&nbsp;</p>
                                </td>
                            </tr>

                            <tr>
                                <td><h2><a name="AssociationEnrichment" >Association&amp;enrichment </a></h2>
                                    <h3><a name="AssociationVariant" >Association at variant</a></h3>

                                    <p><img src="imgs/leaf.gif" width="10" height="8" /> Filtration by statistical association: <tt> --filter-model association</tt></p>
                                    <p><code>java -jar ./kggseq.jar --buildver hg19  --filter-model association --v-assoc-file path/to/file3 --p-value-cutoff 0.01 --multiple-testing benfdr --qqplot</code> Exclude variants which are not interesting in terms of statistical p-values for association calculated by <a href="http://atgu.mgh.harvard.edu/plinkseq/" target="_blank">PLINK/Seq </a>. The <tt>'--p-value-cutoff'</tt> sets p-value cutoffs for filtration; the <tt>'--multiple-testing'</tt> sets the approaches for multiple testing comparisons; and the <tt>'--qqplot'</tt> enables <a href="http://en.wikipedia.org/wiki/Q-Q_plot", target="_blank">Q-Q plot</a> of the association results.</p>
                                    <table  class="list">
                                        <tr>
                                            <td valign="top"><b>Multiple testing method</b></td>
                                            <td valign="top"><b>Description</b></td>
                                        </tr>
                                        <tr>
                                            <td valign="top">no</td>
                                            <td valign="top">No multiple testing methods. Set a fixed p value cutoff by <tt>--p-value-cutoff</tt>.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">benfdr</td>
                                            <td valign="top">Benjamini-Hochberg method, which aims to control the FDR (specified by  <tt>--p-value-cutoff</tt>), or "False Discovery Rate," rather than the FWE or "FamilyWise Error rate".</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">bonhol</td>
                                            <td valign="top">Bonferroni-Holm method, which is less conservative and more powerful than the Standard Bonferroni method given a family-wise error rate specified by <tt>--p-value-cutoff</tt>.</td>
                                        </tr>
                                        <tr>
                                            <td valign="top">bonf</td>
                                            <td valign="top">Standard Bonferroni correction given a family-wise error rate specified by <tt>--p-value-cutoff</tt>.</td>
                                        </tr>
                                    </table>
                                    <p><strong>Note</strong> This functions also supports inputs specified by <tt>--vcf-file</tt>, <tt>--assoc-file</tt>, which is the output of <a href="http://atgu.mgh.harvard.edu/plinkseq/" target="_blank">PLINK/Seq</a> gene-based association analysis result, and <tt>--vaast-simple-file</tt>, which is the output of <a href="http://www.yandell-lab.org/software/vaast.html" target="_blank">VAAST</a>  gene-based association analysis result. </p>

                                    <h3><a name="MutationRateGene" >Mutation rate at gene</a></h3>                                  
                                    Test the non-synonymous mutation rate in a gene by a regression mode <tt>--gene-mutation-rate-test</tt>
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname [other tags] --gene-mutation-rate-test</code>

                                    The model can be expressed as the following:<br/>
                                    <center>[#minor alleles of non-synonymous variants]= [length of coding region] + [#minor alleles of synonymous variants] +[constraint score]+[expression]+[DNA replication timing]+[HiC-based chromatin state estimation]</center> <br/><br/>
                                    The gene &apos;s constraint scores are from <a href="http://www.nature.com/ng/journal/v46/n9/abs/ng.3050.html" target="_blank">Samocha et al (2014) Nature Genetics. </a>. The last three factors are from <a href="http://www.broadinstitute.org/cancer/software/genepattern/modules/docs/MutSigCV" target="_blank">MutSigCV</a>.The assumption of the analysis is that the number of minor alleles of non-synonymous variants in a gene can be normally explained by other factors of the same gene including length of coding region, the number of minor alleles of synonymous variants constraint score and other expression related features on the human genome. However, if a gene contributes to a certain disease by non-synonymous mutations, this gene tends to have more mutant non-synonymous alleles in a sample of this disease.
                                    <br/>  This approach is designed for test gene &apos;s non-synonymous mutation rate in three scenarios.<br/>
                                    1) In cancer samples for gene&apos;s somatic mutation rate: 
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --genotype-filter 8 --indiv-pair tumorIndivID1:normalIndivID1,tumorIndivID2:normalIndivID2 --db-gene refgene --gene-mutation-rate-test</code>



                                    2)In case-only samples for gene&apos;s rare non-synonymous mutation rate : 
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --db-filter 1kg201204,dbsnp137,ESP6500AA,ESP6500EA  --rare-allele-freq 0.01  --db-gene refgene --gene-mutation-rate-test</code>

                                    3)In case-control samples for gene&apos;s case-unique rare non-synonymous mutation rate: 
                                    <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --db-filter 1kg201204,dbsnp137,ESP6500AA,ESP6500EA  --rare-allele-freq 0.01 --filter-model case-unique --db-gene refgene --gene-mutation-rate-test</code>

                                    In the output file of the analysis (*.gene.mutation.rate.xlsx), there are detailed values of all factors used in the regression and the p-values of mutation rate test.
                                    <h4>
                                        <b>GeneSymbol</b>: Official gene symbols defined by HGNC.<br />
                                        <b>AvgCodingLen</b>: The actual or averaged (of multiple isoforms) length (in kb) of all exons in a gene.<br />
                                        <b>NS</b>: The observed number of non-synonymous and splicing somatic sequence variants.<br />
                                        <b>Syn</b>: The observed number of synonymous somatic sequence variants.<br />
                                        [...] <br/>
                                        <b>RegResidue:</b>  Pearson residuals   (raw residuals scaled by square root of variance function) in the regression after correction for the factors. <br />
                                        <b>RegP:</b>  The probability of be equal or over the RegResidue under a standard normal distribution.<br />


                                    </h4>
                                    Note: The detailed method of the analysis will be described in a paper, which is in preparation.
                                    <br />

                                    <h3><a name="GeneSetEnrichment" >GeneSet enrichment</a></h3>                                  
                                    <p>Test whether a gene set is enriched with certain number of genes by Wilcoxon rank sum test:<tt> --geneset-enrichment-test </tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname [other tags] --geneset-enrichment-test</code>

                                        Basically, this analysis is to examine whether a  set of genes is more highly ranked in an ordered list of all genes than would be expected by chance. Therefore,as the rank of gene is a prerequisite, it should be used together with a gene-based association or mutation rate tests.<br/>


                                        1)	Enrichment test based on gene-based association p-values

                                        <br/>
                                        2)	Enrichment test based on gene mutation rate test p-values
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --db-filter 1kg201204,dbsnp137,ESP6500AA,ESP6500EA  --rare-allele-freq 0.01  --db-gene refgene --gene-mutation-rate-test --geneset-enrichment-test --geneset-db &lt;GenesetDatabase&gt;</code>

                                        <p>Currently, there are 5 geneset databases from <a href="http://www.broadinstitute.org/gsea/msigdb/collections.jsp">GSEA</a>. The following are brief descriptions of the 5 datasets COPIED from the <a href="http://www.broadinstitute.org/gsea/msigdb/collections.jsp" target="_blank">page</a> of GSEA.<br/>
                                            <table width="90%" class="list">
                                                <tr>
                                                    <th width="19%" scope="col">GeneSetDatabase</th>
                                                    <th width="66%" scope="col">Description</th>
                                                    <th width="15%" scope="col">Version</th>
                                                </tr>
                                                <tr>
                                                    <td>cano</td>
                                                    <td>Gene sets from the geneset databases. Usually, these gene sets are canonical representations of a biological process compiled by domain experts. (1452 gene sets)</td>
                                                    <td> MSigDB 3.1</td>
                                                </tr>
                                                <tr>
                                                    <td> cura </td>
                                                    <td>Curated gene sets: Gene sets collected from various sources such as online geneset databases, publications in PubMed, and knowledge of domain experts. The gene set page for each gene set lists its source. (4850 gene sets)</td>
                                                    <td> MSigDB 3.1</td>
                                                </tr>
                                                <tr>
                                                    <td> onco </td>
                                                    <td> Oncogenic signatures: Gene sets represent signatures of cellular pathways which are often dis-regulated in cancer. The majority of signatures were generated directly from microarray data from NCBI GEO or from internal unpublished profiling experiments which involved perturbation of known cancer genes. In addition, a small number of oncogenic signatures were curated from scientific publications. (189 gene sets)</td>
                                                    <td> MSigDB 3.1</td>
                                                </tr>
                                                <tr>
                                                    <td> cmop </td>
                                                    <td>Computational gene sets:  Computational gene sets defined by mining large collections of cancer-oriented microarray data. (858 gene sets)</td>
                                                    <td> MSigDB 3.1</td>
                                                </tr>
                                                <tr>
                                                    <td> onto </td>
                                                    <td>GO gene sets Gene sets are named by GO term and contain genes annotated by that term. GSEA users: Gene set enrichment analysis identifies gene sets consisting of co-regulated genes; GO gene sets are based on ontologies and do not necessarily comprise co-regulated genes. (1454 gene sets)</td>
                                                    <td> MSigDB 3.1</td>
                                                </tr>
                                            </table>
                                            <br />
                                            <strong>  Alternatively </strong>, uses can specify the own pathway gene sets in a text file by <tt>--geneset-db path/to/mypahway/file</tt>. The format of the geneset file is:
                                            <h4>
                                                [Column 1: GeneSet ID]<br />
                                                [Column 2: GeneSet URL]<br />
                                                [Column 3..N: Gene Symbols in the geneset; separated by spaces].<br />

                                                No title row is required!!!<br />
                                                <br />

                                                <br />    e.g.,<br />
                                                ----------------------------------------------<br />
                                                KEGG_GLYCOLYSIS_GLUCONEOGENESIS http://www.broadinstitute.org/KEGG_GLYCOLYSIS_GLUCONEOGENESIS.html LDHC LDHB LDHA<br />
                                                KEGG_CITRATE_CYCLE_TCA_CYCLE http://www.broadinstitute.org/KEGG_CITRATE_CYCLE_TCA_CYCLE.html GJB1 OGDHL OGDH PDHB IDH3G LDHB<br />
                                                ...<br />
                                                ...<br />
                                            </h4>
                                            <br />

                                            In the output file of the enrichment analysis (*.geneset.xls), there are detailed statistical evaluation results of each geneset:
                                            <h4>
                                                <b>GeneSetID</b>:the input geneset name or id<br />
                                                <b>WilcoxonP</b>:the p-values of the enrichment test<br />
                                                <b>Gene</b>:the gene of the gene set<br />
                                                <b>GeneP</b>:the p-value of the gene used for the enrichment test<br />
                                            </h4>
                                            <br />
                                        </p>
                                        <p>&nbsp;</p>
                                </td>
                            </tr>


                            <tr>
                                <td><h2><a name="Plotting" >Plotting </a></h2>
                                    <p>Generate a histogram of minor allele frequency (MAF) <tt>--mafplot</tt>
                                        <code>java -jar kggseq.jar --vcf-file path/to/file1 --ped-file path/to/file2 --out path/to/prefixname --db-filter hg18_1kgasn2010,hg18_1kgeur2010,hg18_1kgafr2010,hg18_ESP5400  --allele-freq 0,1  --mafplot</code>
                                        <strong> Note</strong> Currently, --mafplot only supports the inputs specified by --vcf-file and --v-assoc-file.<br />
                                        <br />

                                        Generate a Quantile-Quantile (Q-Q) plot for association p-values <tt>--qqplot</tt>
                                        <code>java -jar kggseq.jar --v-assoc-file path/to/file --out path/to/prefixname --qqplot</code>
                                        <strong> Note</strong> Currently, --mafplot only supports the inputs specified by --assoc-file, --v-assoc-file.<br />
                                        <br />
                                    </p>
                                    <p>&nbsp;</p>
                                </td>
                            </tr>
                            <tr>
                                <td><hr />
                                    <h1><a name="faq" >FAQ? </a></h1>
                                    <p><b>1) Does Kggseq provide gene expression information in the output?</b></p>
                                    <p>Kggseq does not implement any gene expression database for annotating  location or quantity of gene expression. But users can input Kggseq&rsquo;s final  gene list to <em>GeneCards</em> for gene expression information.</p>
                                    <p><b>2) Why Kggseq does not read my VCF file?</b></p>
                                    <p>If you use standard VCF output from GATK pipeline, it usually contains  variants on mitochondrial DNA. However, mitochondrial DNA is not annotated by  gene feature database. Therefore Kggseq currently only accept VCF file  excluding variants on ChrM.</p>
                                    <p><b>3) Is there a link for annotating shared genesets in terms of  biological function?</b></p>
                                    <p>Kggseq implements MsigDB database, therefore each geneset item output by  Kggseq can be directed to a weblink which contain concrete information for the  corresponding geneset.</p>
                                    <p><b>4) How shall I prepare the candidate gene list? What is the gene  list for?</b></p>
                                    <p>The candidate gene list can include any gene interesting to the user. It  may be verified causal gene for the disease, or potential causal gene. The gene  list is used to fish more hidden interesting genes in order to narrow down the  searching region. If no gene list provided, Kggseq can still perform routine  &lsquo;filtration + sharing&rsquo; strategy for sequencing data.</p>
                                    <p><b>5)Suppose I have in-house control genomes in VCF format, how can I  transform it into Kggseq acceptable file?</b></p>
                                    <p>There are two alternative ways to allow you use the in-house VCF data (containing  genotypes of multiple individuals) as filter.</p>
                                    <p>1. Convert the VCF data into a standard kggseq local filter format by the  command: <em>--make-filter --vcf-file path/to/vcffile --buildver-in hg18 --out  test.hg19.var --buildver-out hg19 </em>first. And then set the --local-filter <em>test.hg19.var</em></p>
                                    <p>2. Directly set <em>--local-filter-vcf path/to/vcffile. </em>However, this  way is less efficient than the above way as it will take additional time to  parse the VCF data.</p>
                                    <p><b>6) What is the default setting for minor allele frequency (MAF)  cut-offs in the filtration step? Is there a practical guidance for MAF  selection?</b></p>
                                    <p>The default setting for MAF cut-offs is 0, which means only novel  variants can survive in the filtration process. MAF selection is a difficult  problem, but generally two suggestions can be adopted: for rare Mendelian disease,  MAF cut-off at 0 or 0.01 is reasonable; for common complex disease of  relatively rare alleles with large effect size, MAF cut-off is dependent on  disease prevalence, penetrance and genetic model, so a higher cut-off like 0.05  might be more reasonable.</p>
                                    <p><b>7) Can I use ANNOVAR and Kggseq together on my dataset?</b></p>
                                    <p>Kggseq is quite flexible for interacting with other sequence-oriented  analytical programs/software (including SOAPSNP, ANNOVAR, PLINK/seq, VAAST, etc).  It can accept various input formats, and output different kinds of sequence  data. In case of ANNOVAR, Kggseq can read ANNOVAR-formatted sequence variants,  and write the final remaining variants in ANNOVAR format.</p>
                                    <p><b>8)Can I run Kggseq on my Lenovo or Mac laptop? Is it time consuming  to run a complete Kggseq process?</b></p>
                                    <p>Normally, Kggseq run well and fast with &gt;=1 GB RAM memory. Hence  current laptop are certainty affordable for running Kggseq. The whole process  need only &lt;10 minutes, unless PubMed searching is set in the parameter file.  For PubMed searching, it really depends on the speed of the network and also  the loading of the NCBI PubMed database.</p>
                                    <p><b>9)How do I report an error  or bugs to Kggseq?</b></p>
                                    <p>You are welcomed to join our  google group (<a href="http://groups.google.com/group/kggseq_user?hl=en">http://groups.google.com/group/kggseq_user?hl=en</a>).  This site is used for communication and discussion of Kggseq usage and  functions. You can also directly write an email to <a href="mailto:limx54@yahoo.com">limx54@yahoo.com</a>, or  kggseq_user@googlegroups.com.</p>
                                </td>
                            </tr>
                        </table>

                        <p>&nbsp;</p>
                    </td>
                </tr>
            </table>
        </div>

        <div  id="menu">
            <a href="#Navi:introduction">References</a><br />
            <a href="#Navi:installandrun">Installation</a><br />
            <a href="#Navi:shorttutorials">Tutorials</a>
            <a href="#Navi:quickexamples">Examples</a><br />
            <a href="#Navi:options">Options</a>
            <a href="#Navi:faq">FAQ?</a>
        </div>
    </body>
</html>